{"paragraphs":[{"text":"%md\n\n## Analysing the \"Top 500 Album Dataset\"\n\n[Rolling Stones Top 500 Album](https://www.rollingstone.com/music/lists/500-greatest-albums-of-all-time-20120531) \n\n![alt text](https://img.wennermedia.com/featured/rolling-stone-best-500-albums-jackson-nirvana-pearl-jam-cash-dylan-pink-floyd-974a8046-27a2-4f1a-aabf-ebed7c5af819.jpg \"\")","dateUpdated":"2018-05-16T21:25:20+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Analysing the &ldquo;Top 500 Album Dataset&rdquo;</h2>\n<p><a href=\"https://www.rollingstone.com/music/lists/500-greatest-albums-of-all-time-20120531\">Rolling Stones Top 500 Album</a></p>\n<p><img src=\"https://img.wennermedia.com/featured/rolling-stone-best-500-albums-jackson-nirvana-pearl-jam-cash-dylan-pink-floyd-974a8046-27a2-4f1a-aabf-ebed7c5af819.jpg\" alt=\"alt text\" title=\"\" /></p>\n"}]},"apps":[],"jobName":"paragraph_1526398346939_-2071657831","id":"20180505-143043_1777529663","dateCreated":"2018-05-15T15:32:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:32083"},{"text":"%sh\n\nhadoop fs -ls /user/user0/songDataset\n","user":"user0","dateUpdated":"2018-05-16T21:25:20+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Found 6 items\n-rw-r--r--   1 user0 user0     357162 2018-05-05 18:59 /user/user0/songDataset/Album_Tracks.csv\n-rw-r--r--   1 user0 user0      81374 2018-05-05 18:59 /user/user0/songDataset/Albums.csv\n-rw-r--r--   1 user0 user0      31417 2018-05-05 18:59 /user/user0/songDataset/Artists.csv\n-rw-r--r--   1 user0 user0   26630053 2018-05-05 18:59 /user/user0/songDataset/BillboardHot100.csv\n-rw-r--r--   1 user0 user0    1002343 2018-05-05 18:59 /user/user0/songDataset/Tracks.csv\n-rw-r--r--   1 user0 user0      24470 2018-05-05 18:59 /user/user0/songDataset/top500.csv\n"}]},"apps":[],"jobName":"paragraph_1526505814462_1915089580","id":"20180516-212334_1472730655","dateCreated":"2018-05-16T21:23:34+0000","dateStarted":"2018-05-16T21:23:48+0000","dateFinished":"2018-05-16T21:23:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:32084"},{"text":"%md\n\n#### Information:\n- We have a songDataset folder in HDFS: /user/user0/songDataset\n\n#### Step 1: Import The Top500 Dataset\n\n- We have top500.csv file in HDFS. Let's start with reading this file. Check it's contents \n\n#### Step 2: Enrich Top500 with Albums Data\n\n- We have Albums.csv file in HDFS. Import it and join with Top500 data\n- Create a new column named release_year from release date\n- Clean genre data to have exactly one genre. As you see the data contains multiple genres for some records like: genre1, genre2, genre3...\n- Hint: split(genre,',')[0]\n\n#### Step 3: Enrich Top500 with Artist Data \n- We have Artists.csv file in HDFS. Import it and join with Top500 data\n- Drop columns 'image_url' and 'artist_id'\n- Rename columns (you can use withColumnRenamed('colName', 'newColName') function of dataframes)\n-- 'name' to 'artist'\n-- 'spotify_popularity_score' to 'popularity'\n-- 'spotify_followers' to 'followers'\n- Create a score column from 'rank' column by calculating (501 - rank)\n\n#### Step 3: Find total score for each genre\n\n#### Step 4: Find total score for each genre & release_year\n\n#### Step 5: Calculate a new column, decade from release year and find total scores of each genre according to the decades\n\n#### Step 6: Find the most popular top 10 artists according to the appearance count on the list\n\n#### Step 7: We have the Spotify Popularity and Follower Counts for artists. What is the most popular TOP 10 artist list according to Spotify?\n- We can create a new column spotify popularity by multiplying popularity with follower counts\n- This new column could measure the spotify popularity of each artist\n","user":"user0","dateUpdated":"2018-05-16T21:25:20+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Information:</h4>\n<ul>\n<li>We have a songDataset folder in HDFS: /user/user0/songDataset</li>\n</ul>\n<h4>Step 1: Import The Top500 Dataset</h4>\n<ul>\n<li>We have top500.csv file in HDFS. Let's start with reading this file. Check it's contents</li>\n</ul>\n<h4>Step 2: Enrich Top500 with Albums Data</h4>\n<ul>\n<li>We have Albums.csv file in HDFS. Import it and join with Top500 data</li>\n<li>Create a new column named release_year from release date</li>\n<li>Clean genre data to have exactly one genre. As you see the data contains multiple genres for some records like: genre1, genre2, genre3&hellip;</li>\n<li>Hint: split(genre,',')[0]</li>\n</ul>\n<h4>Step 3: Enrich Top500 with Artist Data</h4>\n<ul>\n<li>We have Artists.csv file in HDFS. Import it and join with Top500 data</li>\n<li>Drop columns 'image_url' and 'artist_id'</li>\n<li>Rename columns (you can use withColumnRenamed('colName', 'newColName') function of dataframes)\n<br  />&ndash; 'name' to 'artist'\n<br  />&ndash; 'spotify_popularity_score' to 'popularity'\n<br  />&ndash; 'spotify_followers' to 'followers'</li>\n<li>Create a score column from 'rank' column by calculating (501 - rank)</li>\n</ul>\n<h4>Step 3: Find total score for each genre</h4>\n<h4>Step 4: Find total score for each genre &amp; release_year</h4>\n<h4>Step 5: Calculate a new column, decade from release year and find total scores of each genre according to the decades</h4>\n<h4>Step 6: Find the most popular top 10 artists according to the appearance count on the list</h4>\n<h4>Step 7: We have the Spotify Popularity and Follower Counts for artists. What is the most popular TOP 10 artist list according to Spotify?</h4>\n<ul>\n<li>We can create a new column spotify popularity by multiplying popularity with follower counts</li>\n<li>This new column could measure the spotify popularity of each artist</li>\n</ul>\n"}]},"apps":[],"jobName":"paragraph_1526398346939_-2071657831","id":"20180505-153347_509980393","dateCreated":"2018-05-15T15:32:26+0000","dateStarted":"2018-05-16T21:24:22+0000","dateFinished":"2018-05-16T21:24:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:32085"},{"text":"%spark2.pyspark\n\n# Start Here\n","dateUpdated":"2018-05-16T21:26:16+0000","config":{"tableHide":false,"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526398346943_-2073196827","id":"20180507-084355_89906588","dateCreated":"2018-05-15T15:32:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:32086"}],"name":"workshops/top500_analytics_empty","id":"2DFQYYDZ5","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C4U48MY3_spark2:user0:":[],"2CK8A9MEG:shared_process":[],"2CKX8WPU1:user0:":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}