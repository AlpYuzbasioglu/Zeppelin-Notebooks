{"paragraphs":[{"text":"%md\n#PySpark Workshop","dateUpdated":"2018-05-16T09:04:12+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"title":false,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>PySpark Workshop</h1>\n"}]},"apps":[],"jobName":"paragraph_1526458718680_963979229","id":"20180507-083713_1855354539","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8776","user":"admin","dateFinished":"2018-05-16T09:01:45+0000","dateStarted":"2018-05-16T09:01:45+0000"},{"text":"%md\n## Systems check\n\nDo you have a working `spark`?","dateUpdated":"2018-05-16T09:04:15+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"title":false,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Systems check</h2>\n<p>Do you have a working <code>spark</code>?</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718680_963979229","id":"20180507-084926_2043145477","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8777","user":"admin","dateFinished":"2018-05-16T09:01:45+0000","dateStarted":"2018-05-16T09:01:45+0000"},{"text":"%spark2.pyspark\nspark.version","dateUpdated":"2018-05-16T09:01:45+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"u'2.2.0.2.6.4.0-91'\n"}]},"apps":[],"jobName":"paragraph_1526458718680_963979229","id":"20180507-083647_435184395","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8778","user":"admin","dateFinished":"2018-05-16T09:02:03+0000","dateStarted":"2018-05-16T09:01:46+0000"},{"text":"%md\nYou can look at these websites:\n\n- [Apache Spark](https://spark.apache.org)\n- [PySpark Documentation](https://spark.apache.org/docs/latest/api/python/)","dateUpdated":"2018-05-16T09:04:20+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>You can look at these websites:</p>\n<ul>\n<li><a href=\"https://spark.apache.org\">Apache Spark</a></li>\n<li><a href=\"https://spark.apache.org/docs/latest/api/python/\">PySpark Documentation</a></li>\n</ul>\n"}]},"apps":[],"jobName":"paragraph_1526458718681_963594481","id":"20180507-132035_832448759","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8779","user":"admin","dateFinished":"2018-05-16T09:01:46+0000","dateStarted":"2018-05-16T09:01:46+0000"},{"text":"%md\n## A little about this workshop\n\nWe'll be analysing a Billboard Hot 100 Charts Data.\n\n[Check out the this week chart](https://www.billboard.com/charts/hot-100)\n\n- Each week since 1958, Billboard magazine has released its Hot 100 chart.\n- This list of the 100 most popular songs in the U.S. according to airplay, streams, and physical sales.\n- This dataset contains every weekly list in 1958 to 2016","dateUpdated":"2018-05-16T09:04:24+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>A little about this workshop</h2>\n<p>We'll be analysing a Billboard Hot 100 Charts Data.</p>\n<p><a href=\"https://www.billboard.com/charts/hot-100\">Check out the this week chart</a></p>\n<ul>\n<li>Each week since 1958, Billboard magazine has released its Hot 100 chart.</li>\n<li>This list of the 100 most popular songs in the U.S. according to airplay, streams, and physical sales.</li>\n<li>This dataset contains every weekly list in 1958 to 2016</li>\n</ul>\n"}]},"apps":[],"jobName":"paragraph_1526458718681_963594481","id":"20180507-084917_1551835436","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8780","user":"admin","dateFinished":"2018-05-16T09:01:48+0000","dateStarted":"2018-05-16T09:01:48+0000"},{"text":"%md\nFirst, let's check out the hadoop file system with Zeppelin `sh` interpreter.","dateUpdated":"2018-05-16T09:04:29+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>First, let's check out the hadoop file system with Zeppelin <code>sh</code> interpreter.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718681_963594481","id":"20180507-103837_141121434","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8781","user":"admin","dateFinished":"2018-05-16T09:01:48+0000","dateStarted":"2018-05-16T09:01:48+0000"},{"text":"%md\n\nDon't forget to change `userX`","user":"admin","dateUpdated":"2018-05-16T09:04:33+0000","config":{"colWidth":12,"enabled":false,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526461377275_-320148967","id":"20180516-090257_1454852207","dateCreated":"2018-05-16T09:02:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:19287","dateFinished":"2018-05-16T09:03:42+0000","dateStarted":"2018-05-16T09:03:42+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Don't forget to change <code>userX</code></p>\n"}]}},{"text":"%sh\nhadoop fs -ls /user/userX/zpl/","dateUpdated":"2018-05-16T09:05:31+0000","config":{"tableHide":false,"editorSetting":{"language":"sh","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sh","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Found 2 items\n-rw-r--r--   1 hdfs user0   26658115 2018-05-16 08:44 /user/user0/zpl/billboardHot100.csv\n-rw-r--r--   1 hdfs user0    2379383 2018-05-16 08:46 /user/user0/zpl/trackFeatures.csv\n"}]},"apps":[],"jobName":"paragraph_1526458718681_963594481","id":"20180507-083701_1371406739","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8782","user":"admin","dateFinished":"2018-05-16T09:04:38+0000","dateStarted":"2018-05-16T09:04:37+0000"},{"text":"%md\n### Beginning\n\nLet's load data with spark `read` function, and dive in to it.","dateUpdated":"2018-05-16T09:04:44+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Beginning</h3>\n<p>Let's load data with spark <code>read</code> function, and dive in to it.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718682_964748727","id":"20180507-102246_2088517579","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8783","user":"admin","dateFinished":"2018-05-16T09:01:50+0000","dateStarted":"2018-05-16T09:01:50+0000"},{"text":"%spark2.pyspark\n\nbillboardDF = spark.read.csv(\"/user/userX/zpl/billboardHot100.csv\", header=True, inferSchema=True)","dateUpdated":"2018-05-16T09:05:25+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1526458718682_964748727","id":"20180507-083852_1755309792","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8784","user":"admin","dateFinished":"2018-05-16T09:05:09+0000","dateStarted":"2018-05-16T09:05:02+0000"},{"text":"%md\n\nAs you can see, our data in `csv` format, but you can use `read` method with `parquet`, `json`, `orc` and `text`. \n\nAlso we gave extra 2 parameters. Let's check out schema inference works as expected by spark `printSchema` method.","dateUpdated":"2018-05-16T09:05:16+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>As you can see, our data in <code>csv</code> format, but you can use <code>read</code> method with <code>parquet</code>, <code>json</code>, <code>orc</code> and <code>text</code>.</p>\n<p>Also we gave extra 2 parameters. Let's check out schema inference works as expected by spark <code>printSchema</code> method.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718682_964748727","id":"20180507-110502_478710225","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8785","user":"admin","dateFinished":"2018-05-16T09:01:51+0000","dateStarted":"2018-05-16T09:01:51+0000"},{"text":"%spark2.pyspark\n\nbillboardDF.printSchema()","dateUpdated":"2018-05-16T09:05:35+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- id: integer (nullable = true)\n |-- artist: string (nullable = true)\n |-- title: string (nullable = true)\n |-- country: string (nullable = true)\n |-- date: timestamp (nullable = true)\n |-- genre: string (nullable = true)\n |-- rank: integer (nullable = true)\n |-- track_id: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1526458718682_964748727","id":"20180507-105433_1755798065","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8786","user":"admin","dateFinished":"2018-05-16T09:05:36+0000","dateStarted":"2018-05-16T09:05:36+0000"},{"text":"%md\n\nField names and types looks good except \"**date**\" column but we can change it later. \n\nLet's take a look at rows.\n\nFor displaying data, you can use **spark** `show` method or **ZeppelinContext** show method(`z.show`).","dateUpdated":"2018-05-16T09:05:43+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Field names and types looks good except &ldquo;<strong>date</strong>&rdquo; column but we can change it later.</p>\n<p>Let's take a look at rows.</p>\n<p>For displaying data, you can use <strong>spark</strong> <code>show</code> method or <strong>ZeppelinContext</strong> show method(<code>z.show</code>).</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718682_964748727","id":"20180507-104821_405010467","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8787","user":"admin","dateFinished":"2018-05-16T09:01:52+0000","dateStarted":"2018-05-16T09:01:52+0000"},{"text":"%spark2.pyspark\n\nbillboardDF.show()","dateUpdated":"2018-05-16T09:06:07+0000","config":{"colWidth":6,"editorMode":"ace/mode/python","results":{"0":{"graph":{"mode":"table","height":340,"optionOpen":false}}},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+--------------------+--------------------+-------------+-------------------+--------------------+----+--------+\n| id|              artist|               title|      country|               date|               genre|rank|track_id|\n+---+--------------------+--------------------+-------------+-------------------+--------------------+----+--------+\n|  0|         Johnny Otis|Willie And The Ha...|United States|1958-09-08 00:00:00|               Blues|   9|    null|\n|  1|      Gerry Granahan|  No Chemise, Please|United States|1958-09-08 00:00:00|               Blues|  36|    null|\n|  2|         Fats Domino|         Little Mary|United States|1958-09-08 00:00:00|               Blues|  95|    null|\n|  3|         Johnny Cash|Guess Things Happ...|United States|1958-09-08 00:00:00|             Country|  21|    null|\n|  4|       Marty Robbins|She Was Only Seve...|United States|1958-09-08 00:00:00|             Country|  94|    null|\n|  5|          Don Gibson|       Blue Blue Day|United States|1958-09-08 00:00:00|             Country|  32|    null|\n|  6|         Sheb Wooley|The Purple People...|United States|1958-09-08 00:00:00|             Country|  24|    null|\n|  7|         Kitty Wells|            Jealousy|United States|1958-09-08 00:00:00|             Country|  87|    null|\n|  8|          Jim Reeves|            Blue Boy|United States|1958-09-08 00:00:00|             Country|  89|    null|\n|  9|      Jimmie Rodgers| Are You Really Mine|United States|1958-09-08 00:00:00|             Country|  93|    null|\n| 10|      Jimmie Rodgers|            Secretly|United States|1958-09-08 00:00:00|             Country|  28|    null|\n| 11|         The Upbeats|Just Like In The ...|  New Zealand|1958-09-08 00:00:00|House/Electronic/...|  88|    null|\n| 12|        Bill Doggett|           Blip Blop|United States|1958-09-08 00:00:00|                Jazz|  82|    null|\n| 13|    Domenico Modugno|Nel Blu Dipinto D...|        Italy|1958-09-08 00:00:00|                 Pop|  54|    null|\n| 14|       The Four Lads|    Enchanted Island|       Canada|1958-09-08 00:00:00|     Traditional Pop|  29|    null|\n| 15|        The Diamonds|         Happy Years|       Canada|1958-09-08 00:00:00|     Traditional Pop|  77|    null|\n| 16|        The Diamonds|             Kathy-O|       Canada|1958-09-08 00:00:00|     Traditional Pop|  45|    null|\n| 17|           Paul Anka|            Midnight|       Canada|1958-09-08 00:00:00|     Traditional Pop|  76|    null|\n| 18|Perez Prado & His...|            Patricia|         Cuba|1958-09-08 00:00:00|     Traditional Pop|   2|    null|\n| 19|     Frankie Vaughan|                Judy|      England|1958-09-08 00:00:00|     Traditional Pop| 100|    null|\n+---+--------------------+--------------------+-------------+-------------------+--------------------+----+--------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1526458718683_964363978","id":"20180508-090638_6233992","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8788","user":"admin","dateFinished":"2018-05-16T09:06:07+0000","dateStarted":"2018-05-16T09:06:07+0000"},{"text":"%spark2.pyspark\n\nz.show(billboardDF.limit(20))","dateUpdated":"2018-05-16T09:06:10+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":6,"editorMode":"ace/mode/python","editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":true},"helium":{}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\tartist\ttitle\tcountry\tdate\tgenre\trank\ttrack_id\n0\tJohnny Otis\tWillie And The Hand Jive\tUnited States\t1958-09-08 00:00:00.0\tBlues\t9\tnull\n1\tGerry Granahan\tNo Chemise, Please\tUnited States\t1958-09-08 00:00:00.0\tBlues\t36\tnull\n2\tFats Domino\tLittle Mary\tUnited States\t1958-09-08 00:00:00.0\tBlues\t95\tnull\n3\tJohnny Cash\tGuess Things Happen That Way\tUnited States\t1958-09-08 00:00:00.0\tCountry\t21\tnull\n4\tMarty Robbins\tShe Was Only Seventeen\tUnited States\t1958-09-08 00:00:00.0\tCountry\t94\tnull\n5\tDon Gibson\tBlue Blue Day\tUnited States\t1958-09-08 00:00:00.0\tCountry\t32\tnull\n6\tSheb Wooley\tThe Purple People Eater\tUnited States\t1958-09-08 00:00:00.0\tCountry\t24\tnull\n7\tKitty Wells\tJealousy\tUnited States\t1958-09-08 00:00:00.0\tCountry\t87\tnull\n8\tJim Reeves\tBlue Boy\tUnited States\t1958-09-08 00:00:00.0\tCountry\t89\tnull\n9\tJimmie Rodgers\tAre You Really Mine\tUnited States\t1958-09-08 00:00:00.0\tCountry\t93\tnull\n10\tJimmie Rodgers\tSecretly\tUnited States\t1958-09-08 00:00:00.0\tCountry\t28\tnull\n11\tThe Upbeats\tJust Like In The Movies\tNew Zealand\t1958-09-08 00:00:00.0\tHouse/Electronic/Trance\t88\tnull\n12\tBill Doggett\tBlip Blop\tUnited States\t1958-09-08 00:00:00.0\tJazz\t82\tnull\n13\tDomenico Modugno\tNel Blu Dipinto Di Blu (Volare)\tItaly\t1958-09-08 00:00:00.0\tPop\t54\tnull\n14\tThe Four Lads\tEnchanted Island\tCanada\t1958-09-08 00:00:00.0\tTraditional Pop\t29\tnull\n15\tThe Diamonds\tHappy Years\tCanada\t1958-09-08 00:00:00.0\tTraditional Pop\t77\tnull\n16\tThe Diamonds\tKathy-O\tCanada\t1958-09-08 00:00:00.0\tTraditional Pop\t45\tnull\n17\tPaul Anka\tMidnight\tCanada\t1958-09-08 00:00:00.0\tTraditional Pop\t76\tnull\n18\tPerez Prado & His Orchestra\tPatricia\tCuba\t1958-09-08 00:00:00.0\tTraditional Pop\t2\tnull\n19\tFrankie Vaughan\tJudy\tEngland\t1958-09-08 00:00:00.0\tTraditional Pop\t100\tnull\n"}]},"apps":[],"jobName":"paragraph_1526458718683_964363978","id":"20180507-102454_1089025036","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8789","user":"admin","dateFinished":"2018-05-16T09:06:10+0000","dateStarted":"2018-05-16T09:06:10+0000"},{"text":"%md\n\nAlso you can `select` method for projecting some or all fields of a dataframe.\n\nFor giving new names to columns, we will use `alias` function.\n\nAnd we will use `limit` function for limiting result.","dateUpdated":"2018-05-16T09:06:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Also you can <code>select</code> method for projecting some or all fields of a dataframe.</p>\n<p>For giving new names to columns, we will use <code>alias</code> function.</p>\n<p>And we will use <code>limit</code> function for limiting result.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718683_964363978","id":"20180507-160551_1678388400","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8790","user":"admin","dateFinished":"2018-05-16T09:01:53+0000","dateStarted":"2018-05-16T09:01:53+0000"},{"text":"%spark2.pyspark\n\nz.show(\n    billboardDF\n    .select(billboardDF.artist, billboardDF.country)\n    .limit(20)\n)","dateUpdated":"2018-05-16T09:07:30+0000","config":{"editorSetting":{"language":"python"},"colWidth":4,"editorMode":"ace/mode/python","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"artist\tcountry\nJohnny Otis\tUnited States\nGerry Granahan\tUnited States\nFats Domino\tUnited States\nJohnny Cash\tUnited States\nMarty Robbins\tUnited States\nDon Gibson\tUnited States\nSheb Wooley\tUnited States\nKitty Wells\tUnited States\nJim Reeves\tUnited States\nJimmie Rodgers\tUnited States\nJimmie Rodgers\tUnited States\nThe Upbeats\tNew Zealand\nBill Doggett\tUnited States\nDomenico Modugno\tItaly\nThe Four Lads\tCanada\nThe Diamonds\tCanada\nThe Diamonds\tCanada\nPaul Anka\tCanada\nPerez Prado & His Orchestra\tCuba\nFrankie Vaughan\tEngland\n"}]},"apps":[],"jobName":"paragraph_1526458718683_964363978","id":"20180508-093317_433627084","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8792","user":"admin","dateFinished":"2018-05-16T09:07:31+0000","dateStarted":"2018-05-16T09:07:31+0000","focus":true},{"text":"%spark2.pyspark\n\nz.show(\n    billboardDF\n    .select(billboardDF[\"title\"], billboardDF[\"date\"].alias(\"release_date\"))\n    .limit(20)\n)","dateUpdated":"2018-05-16T09:07:24+0000","config":{"colWidth":4,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"title\trelease_date\nWillie And The Hand Jive\t1958-09-08 00:00:00.0\nNo Chemise, Please\t1958-09-08 00:00:00.0\nLittle Mary\t1958-09-08 00:00:00.0\nGuess Things Happen That Way\t1958-09-08 00:00:00.0\nShe Was Only Seventeen\t1958-09-08 00:00:00.0\nBlue Blue Day\t1958-09-08 00:00:00.0\nThe Purple People Eater\t1958-09-08 00:00:00.0\nJealousy\t1958-09-08 00:00:00.0\nBlue Boy\t1958-09-08 00:00:00.0\nAre You Really Mine\t1958-09-08 00:00:00.0\nSecretly\t1958-09-08 00:00:00.0\nJust Like In The Movies\t1958-09-08 00:00:00.0\nBlip Blop\t1958-09-08 00:00:00.0\nNel Blu Dipinto Di Blu (Volare)\t1958-09-08 00:00:00.0\nEnchanted Island\t1958-09-08 00:00:00.0\nHappy Years\t1958-09-08 00:00:00.0\nKathy-O\t1958-09-08 00:00:00.0\nMidnight\t1958-09-08 00:00:00.0\nPatricia\t1958-09-08 00:00:00.0\nJudy\t1958-09-08 00:00:00.0\n"}]},"apps":[],"jobName":"paragraph_1526458718684_962440234","id":"20180508-092743_1079006608","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8793","user":"admin","dateFinished":"2018-05-16T09:07:24+0000","dateStarted":"2018-05-16T09:07:24+0000"},{"text":"%spark2.pyspark\n\nz.show( \n    billboardDF\n    .select('artist', 'title', 'rank')\n    .limit(20)\n)","user":"admin","dateUpdated":"2018-05-16T09:07:28+0000","config":{"colWidth":4,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526461599415_1076644427","id":"20180516-090639_833978334","dateCreated":"2018-05-16T09:06:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:19878","dateFinished":"2018-05-16T09:07:28+0000","dateStarted":"2018-05-16T09:07:28+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"artist\ttitle\trank\nJohnny Otis\tWillie And The Hand Jive\t9\nGerry Granahan\tNo Chemise, Please\t36\nFats Domino\tLittle Mary\t95\nJohnny Cash\tGuess Things Happen That Way\t21\nMarty Robbins\tShe Was Only Seventeen\t94\nDon Gibson\tBlue Blue Day\t32\nSheb Wooley\tThe Purple People Eater\t24\nKitty Wells\tJealousy\t87\nJim Reeves\tBlue Boy\t89\nJimmie Rodgers\tAre You Really Mine\t93\nJimmie Rodgers\tSecretly\t28\nThe Upbeats\tJust Like In The Movies\t88\nBill Doggett\tBlip Blop\t82\nDomenico Modugno\tNel Blu Dipinto Di Blu (Volare)\t54\nThe Four Lads\tEnchanted Island\t29\nThe Diamonds\tHappy Years\t77\nThe Diamonds\tKathy-O\t45\nPaul Anka\tMidnight\t76\nPerez Prado & His Orchestra\tPatricia\t2\nFrankie Vaughan\tJudy\t100\n"}]}},{"text":"%md\n\nDon't forget that `select` method returns a new dataframe and it's a transformation.","dateUpdated":"2018-05-16T09:07:46+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Don't forget that <code>select</code> method returns a new dataframe and it's a transformation.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718684_962440234","id":"20180508-093921_1040157749","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8794","user":"admin","dateFinished":"2018-05-16T09:01:54+0000","dateStarted":"2018-05-16T09:01:54+0000"},{"text":"%md\n\n### Question 1\n\nWhat are the genres in the dataset?","dateUpdated":"2018-05-16T09:08:00+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Question 1</h3>\n<p>What are the genres in the dataset?</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718684_962440234","id":"20180508-100415_163434581","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8795","user":"admin","dateFinished":"2018-05-16T09:01:55+0000","dateStarted":"2018-05-16T09:01:55+0000"},{"text":"%md\n\nFor answering first question, we can use `distinct` method of spark.","dateUpdated":"2018-05-16T09:08:04+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>For answering first question, we can use <code>distinct</code> method of spark.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718684_962440234","id":"20180508-100549_1789325537","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8796","user":"admin","dateFinished":"2018-05-16T09:01:55+0000","dateStarted":"2018-05-16T09:01:55+0000"},{"text":"%spark2.pyspark\n\nz.show(\n    billboardDF\n    .select(billboardDF[\"genre\"])\n    .distinct()\n)","dateUpdated":"2018-05-16T09:08:09+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"genre\nSka/Reggae/Dancehall\nRap/Hip-Hop\nLatin\nMetal\nRock\nJazz\nHouse/Electronic/Trance\nFolk\nBlues\nR&B\nTraditional Pop\nRock & Roll\nPop\nPunk\nSoul\nCountry\n"}]},"apps":[],"jobName":"paragraph_1526458718685_962055485","id":"20180508-100954_1564768568","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8797","user":"admin","dateFinished":"2018-05-16T09:08:12+0000","dateStarted":"2018-05-16T09:08:10+0000"},{"text":"%md\n\n### Question 2\n\nHow many different songs does the dataset contains?","dateUpdated":"2018-05-16T09:08:20+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Question 2</h3>\n<p>How many different songs does the dataset contains?</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718685_962055485","id":"20180507-131623_1073647555","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8798","user":"admin","dateFinished":"2018-05-16T09:01:56+0000","dateStarted":"2018-05-16T09:01:56+0000"},{"text":"%spark2.pyspark\n\nbillboardDF.distinct().count()","dateUpdated":"2018-05-16T09:08:23+0000","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"296988\n"}]},"apps":[],"jobName":"paragraph_1526458718685_962055485","id":"20180507-143205_1072582545","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8799","user":"admin","dateFinished":"2018-05-16T09:08:26+0000","dateStarted":"2018-05-16T09:08:23+0000"},{"text":"%md\n\nIs distinct count value the answer we are looking for?\n\nFirst things first, let's drop the duplicate rows.\n\nFor removing duplicates, we can use `dropDuplicates` method.","dateUpdated":"2018-05-16T09:08:33+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Is distinct count value the answer we are looking for?</p>\n<p>First things first, let's drop the duplicate rows.</p>\n<p>For removing duplicates, we can use <code>dropDuplicates</code> method.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718685_962055485","id":"20180507-143648_1426841215","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8800","user":"admin","dateFinished":"2018-05-16T09:01:57+0000","dateStarted":"2018-05-16T09:01:57+0000"},{"text":"%spark2.pyspark\n\nbillboardDF = billboardDF.dropDuplicates()\nbillboardDF.count()","dateUpdated":"2018-05-16T09:08:35+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"296988\n"}]},"apps":[],"jobName":"paragraph_1526458718685_962055485","id":"20180507-143527_1140685276","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8801","user":"admin","dateFinished":"2018-05-16T09:08:38+0000","dateStarted":"2018-05-16T09:08:36+0000"},{"text":"%md\n\nWell the dataset does not contains duplicate rows, but probably has duplicate songs.\n\nFor check this let's filter our dataset with \"**Frank Sinatra's My Way**\" song.","dateUpdated":"2018-05-16T09:08:44+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Well the dataset does not contains duplicate rows, but probably has duplicate songs.</p>\n<p>For check this let's filter our dataset with &ldquo;<strong>Frank Sinatra's My Way</strong>&rdquo; song.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718685_962055485","id":"20180507-140435_664460556","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8802","user":"admin","dateFinished":"2018-05-16T09:01:58+0000","dateStarted":"2018-05-16T09:01:58+0000"},{"text":"%spark2.pyspark\n\nz.show(\n    billboardDF\n    .filter(billboardDF['artist'] == \"Frank Sinatra\")\n    .filter(billboardDF['title'] == \"My Way\")\n)","dateUpdated":"2018-05-16T09:08:47+0000","config":{"editorSetting":{"language":"python"},"colWidth":6,"editorMode":"ace/mode/python","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\tartist\ttitle\tcountry\tdate\tgenre\trank\ttrack_id\n38753\tFrank Sinatra\tMy Way\tUnited States\t1969-12-04 00:00:00.0\tTraditional Pop\t37\t0mdefZ4yfFr2DehHGIqLCX\n48206\tFrank Sinatra\tMy Way\tUnited States\t1969-05-17 00:00:00.0\tTraditional Pop\t32\t0mdefZ4yfFr2DehHGIqLCX\n48109\tFrank Sinatra\tMy Way\tUnited States\t1969-10-05 00:00:00.0\tTraditional Pop\t27\t0mdefZ4yfFr2DehHGIqLCX\n38650\tFrank Sinatra\tMy Way\tUnited States\t1969-05-04 00:00:00.0\tTraditional Pop\t41\t0mdefZ4yfFr2DehHGIqLCX\n38550\tFrank Sinatra\tMy Way\tUnited States\t1969-03-29 00:00:00.0\tTraditional Pop\t69\t0mdefZ4yfFr2DehHGIqLCX\n48008\tFrank Sinatra\tMy Way\tUnited States\t1969-03-05 00:00:00.0\tTraditional Pop\t29\t0mdefZ4yfFr2DehHGIqLCX\n38950\tFrank Sinatra\tMy Way\tUnited States\t1969-04-26 00:00:00.0\tTraditional Pop\t30\t0mdefZ4yfFr2DehHGIqLCX\n38849\tFrank Sinatra\tMy Way\tUnited States\t1969-04-19 00:00:00.0\tTraditional Pop\t33\t0mdefZ4yfFr2DehHGIqLCX\n"}]},"apps":[],"jobName":"paragraph_1526458718685_962055485","id":"20180507-135954_1587650450","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8803","user":"admin","dateFinished":"2018-05-16T09:08:49+0000","dateStarted":"2018-05-16T09:08:47+0000"},{"text":"%spark2.pyspark\n\nz.show(\n    billboardDF\n    .where(billboardDF['artist'] == \"Frank Sinatra\")\n    .where(billboardDF['title'] == \"My Way\")\n)","dateUpdated":"2018-05-16T09:08:51+0000","config":{"colWidth":6,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\tartist\ttitle\tcountry\tdate\tgenre\trank\ttrack_id\n38753\tFrank Sinatra\tMy Way\tUnited States\t1969-12-04 00:00:00.0\tTraditional Pop\t37\t0mdefZ4yfFr2DehHGIqLCX\n48206\tFrank Sinatra\tMy Way\tUnited States\t1969-05-17 00:00:00.0\tTraditional Pop\t32\t0mdefZ4yfFr2DehHGIqLCX\n48109\tFrank Sinatra\tMy Way\tUnited States\t1969-10-05 00:00:00.0\tTraditional Pop\t27\t0mdefZ4yfFr2DehHGIqLCX\n38650\tFrank Sinatra\tMy Way\tUnited States\t1969-05-04 00:00:00.0\tTraditional Pop\t41\t0mdefZ4yfFr2DehHGIqLCX\n38550\tFrank Sinatra\tMy Way\tUnited States\t1969-03-29 00:00:00.0\tTraditional Pop\t69\t0mdefZ4yfFr2DehHGIqLCX\n48008\tFrank Sinatra\tMy Way\tUnited States\t1969-03-05 00:00:00.0\tTraditional Pop\t29\t0mdefZ4yfFr2DehHGIqLCX\n38950\tFrank Sinatra\tMy Way\tUnited States\t1969-04-26 00:00:00.0\tTraditional Pop\t30\t0mdefZ4yfFr2DehHGIqLCX\n38849\tFrank Sinatra\tMy Way\tUnited States\t1969-04-19 00:00:00.0\tTraditional Pop\t33\t0mdefZ4yfFr2DehHGIqLCX\n"}]},"apps":[],"jobName":"paragraph_1526458718685_962055485","id":"20180514-121048_607598490","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8804","user":"admin","dateFinished":"2018-05-16T09:08:53+0000","dateStarted":"2018-05-16T09:08:52+0000"},{"text":"%md\nPlease notice that, `where` is alias for `filter`","dateUpdated":"2018-05-16T09:09:13+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Please notice that, <code>where</code> is alias for <code>filter</code></p>\n"}]},"apps":[],"jobName":"paragraph_1526458718686_963209732","id":"20180514-121349_1720405946","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8805","user":"admin","dateFinished":"2018-05-16T09:01:58+0000","dateStarted":"2018-05-16T09:01:58+0000"},{"text":"%md\n\nAs you can see \"**My Way**\" is in the hot 100 list for 8 different times.","dateUpdated":"2018-05-16T09:09:16+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>As you can see &ldquo;<strong>My Way</strong>&rdquo; is in the hot 100 list for 8 different times.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718686_963209732","id":"20180507-152005_1976293907","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8806","user":"admin","dateFinished":"2018-05-16T09:01:58+0000","dateStarted":"2018-05-16T09:01:58+0000"},{"text":"%md\n\nWe need a unique column for getting distinct song count.\n\nLet's try out **title** column first.\n\nFor testing, we can filtering with \"**My Way**\" song.","dateUpdated":"2018-05-16T09:01:58+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>We need a unique column for getting distinct song count.</p>\n<p>Let's try out <strong>title</strong> column first.</p>\n<p>For testing, we can filtering with &ldquo;<strong>My Way</strong>&rdquo; song.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718686_963209732","id":"20180514-120828_2071839447","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8807","user":"admin","dateFinished":"2018-05-16T09:01:59+0000","dateStarted":"2018-05-16T09:01:59+0000"},{"text":"%spark2.pyspark\n\nz.show(billboardDF.filter(billboardDF['title'] == \"My Way\"))","dateUpdated":"2018-05-16T09:09:29+0000","config":{"colWidth":6,"editorMode":"ace/mode/python","results":{"0":{"graph":{"mode":"table","height":328,"optionOpen":false}}},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\tartist\ttitle\tcountry\tdate\tgenre\trank\ttrack_id\n215776\tUsher\tMy Way\tUnited States\t1998-10-17 00:00:00.0\tR&B\t11\t5PIveStlGgjVL54GpVcqxr\n203044\tUsher\tMy Way\tUnited States\t1998-07-18 00:00:00.0\tR&B\t3\t5PIveStlGgjVL54GpVcqxr\n76830\tElvis Presley\tMy Way\tUnited States\t1978-07-01 00:00:00.0\tRock & Roll\t22\t7ffB6ngbE3C6G050SUclvv\n38753\tFrank Sinatra\tMy Way\tUnited States\t1969-12-04 00:00:00.0\tTraditional Pop\t37\t0mdefZ4yfFr2DehHGIqLCX\n39696\tBrook Benton\tMy Way\tUnited States\t1970-05-16 00:00:00.0\tSoul\t74\t0fcvrAmbVEy6V9szoadvNY\n210404\tUsher\tMy Way\tUnited States\t1998-08-22 00:00:00.0\tR&B\t2\t5PIveStlGgjVL54GpVcqxr\n271671\tFetty Wap\tMy Way\tUnited States\t2015-10-31 00:00:00.0\tRap/Hip-Hop\t21\t7zpZQzTwWBN0eOsmb4WPH3\n205935\tLimp Bizkit\tMy Way\tUnited States\t2001-07-14 00:00:00.0\tMetal\t100\t3oXhBXVfDz63XlmaVqOg3G\n264008\tFetty Wap\tMy Way\tUnited States\t2015-12-09 00:00:00.0\tRap/Hip-Hop\t11\t7zpZQzTwWBN0eOsmb4WPH3\n264108\tFetty Wap\tMy Way\tUnited States\t2015-09-19 00:00:00.0\tRap/Hip-Hop\t16\t7zpZQzTwWBN0eOsmb4WPH3\n199575\tLimp Bizkit\tMy Way\tUnited States\t2001-02-06 00:00:00.0\tMetal\t75\t3oXhBXVfDz63XlmaVqOg3G\n48206\tFrank Sinatra\tMy Way\tUnited States\t1969-05-17 00:00:00.0\tTraditional Pop\t32\t0mdefZ4yfFr2DehHGIqLCX\n271571\tFetty Wap\tMy Way\tUnited States\t2015-10-24 00:00:00.0\tRap/Hip-Hop\t18\t7zpZQzTwWBN0eOsmb4WPH3\n76544\tElvis Presley\tMy Way\tUnited States\t1977-12-17 00:00:00.0\tRock & Roll\t28\t7ffB6ngbE3C6G050SUclvv\n210022\tUsher\tMy Way\tUnited States\t1998-07-25 00:00:00.0\tR&B\t3\t5PIveStlGgjVL54GpVcqxr\n48109\tFrank Sinatra\tMy Way\tUnited States\t1969-10-05 00:00:00.0\tTraditional Pop\t27\t0mdefZ4yfFr2DehHGIqLCX\n202660\tUsher\tMy Way\tUnited States\t1998-06-20 00:00:00.0\tR&B\t13\t5PIveStlGgjVL54GpVcqxr\n202948\tUsher\tMy Way\tUnited States\t1998-11-07 00:00:00.0\tR&B\t4\t5PIveStlGgjVL54GpVcqxr\n264210\tFetty Wap\tMy Way\tUnited States\t2015-09-26 00:00:00.0\tRap/Hip-Hop\t15\t7zpZQzTwWBN0eOsmb4WPH3\n76641\tElvis Presley\tMy Way\tUnited States\t1977-12-24 00:00:00.0\tRock & Roll\t22\t7ffB6ngbE3C6G050SUclvv\n205535\tLimp Bizkit\tMy Way\tUnited States\t2001-06-16 00:00:00.0\tMetal\t79\t3oXhBXVfDz63XlmaVqOg3G\n38650\tFrank Sinatra\tMy Way\tUnited States\t1969-05-04 00:00:00.0\tTraditional Pop\t41\t0mdefZ4yfFr2DehHGIqLCX\n272378\tFetty Wap\tMy Way\tUnited States\t2015-12-19 00:00:00.0\tRap/Hip-Hop\t43\t7zpZQzTwWBN0eOsmb4WPH3\n216074\tUsher\tMy Way\tUnited States\t1998-07-11 00:00:00.0\tR&B\t23\t5PIveStlGgjVL54GpVcqxr\n202851\tUsher\tMy Way\tUnited States\t1998-04-07 00:00:00.0\tR&B\t5\t5PIveStlGgjVL54GpVcqxr\n39411\tBrook Benton\tMy Way\tUnited States\t1970-04-25 00:00:00.0\tSoul\t84\t0fcvrAmbVEy6V9szoadvNY\n76922\tElvis Presley\tMy Way\tUnited States\t1978-01-14 00:00:00.0\tRock & Roll\t35\t7ffB6ngbE3C6G050SUclvv\n205434\tLimp Bizkit\tMy Way\tUnited States\t2001-09-06 00:00:00.0\tMetal\t75\t3oXhBXVfDz63XlmaVqOg3G\n272281\tFetty Wap\tMy Way\tUnited States\t2015-12-12 00:00:00.0\tRap/Hip-Hop\t35\t7zpZQzTwWBN0eOsmb4WPH3\n206037\tLimp Bizkit\tMy Way\tUnited States\t2001-07-21 00:00:00.0\tMetal\t95\t3oXhBXVfDz63XlmaVqOg3G\n76738\tElvis Presley\tMy Way\tUnited States\t1977-12-31 00:00:00.0\tRock & Roll\t22\t7ffB6ngbE3C6G050SUclvv\n39507\tBrook Benton\tMy Way\tUnited States\t1970-02-05 00:00:00.0\tSoul\t84\t0fcvrAmbVEy6V9szoadvNY\n76163\tElvis Presley\tMy Way\tUnited States\t1977-11-19 00:00:00.0\tRock & Roll\t60\t7ffB6ngbE3C6G050SUclvv\n76258\tElvis Presley\tMy Way\tUnited States\t1977-11-26 00:00:00.0\tRock & Roll\t48\t7ffB6ngbE3C6G050SUclvv\n39601\tBrook Benton\tMy Way\tUnited States\t1970-09-05 00:00:00.0\tSoul\t81\t0fcvrAmbVEy6V9szoadvNY\n199477\tLimp Bizkit\tMy Way\tUnited States\t2001-05-26 00:00:00.0\tMetal\t75\t3oXhBXVfDz63XlmaVqOg3G\n216376\tUsher\tMy Way\tUnited States\t1998-11-28 00:00:00.0\tR&B\t36\t5PIveStlGgjVL54GpVcqxr\n271378\tFetty Wap\tMy Way\tUnited States\t2015-10-10 00:00:00.0\tRap/Hip-Hop\t15\t7zpZQzTwWBN0eOsmb4WPH3\n39314\tBrook Benton\tMy Way\tUnited States\t1970-04-18 00:00:00.0\tSoul\t97\t0fcvrAmbVEy6V9szoadvNY\n76353\tElvis Presley\tMy Way\tUnited States\t1977-03-12 00:00:00.0\tRock & Roll\t38\t7ffB6ngbE3C6G050SUclvv\n77115\tElvis Presley\tMy Way\tUnited States\t1978-01-28 00:00:00.0\tRock & Roll\t86\t7ffB6ngbE3C6G050SUclvv\n38550\tFrank Sinatra\tMy Way\tUnited States\t1969-03-29 00:00:00.0\tTraditional Pop\t69\t0mdefZ4yfFr2DehHGIqLCX\n263813\tFetty Wap\tMy Way\tUnited States\t2015-08-29 00:00:00.0\tRap/Hip-Hop\t8\t7zpZQzTwWBN0eOsmb4WPH3\n263517\tFetty Wap\tMy Way\tUnited States\t2015-08-08 00:00:00.0\tRap/Hip-Hop\t7\t7zpZQzTwWBN0eOsmb4WPH3\n263708\tFetty Wap\tMy Way\tUnited States\t2015-08-22 00:00:00.0\tRap/Hip-Hop\t10\t7zpZQzTwWBN0eOsmb4WPH3\n271875\tFetty Wap\tMy Way\tUnited States\t2015-11-14 00:00:00.0\tRap/Hip-Hop\t28\t7zpZQzTwWBN0eOsmb4WPH3\n48008\tFrank Sinatra\tMy Way\tUnited States\t1969-03-05 00:00:00.0\tTraditional Pop\t29\t0mdefZ4yfFr2DehHGIqLCX\n206135\tLimp Bizkit\tMy Way\tUnited States\t2001-07-28 00:00:00.0\tMetal\t100\t3oXhBXVfDz63XlmaVqOg3G\n210502\tUsher\tMy Way\tUnited States\t1998-08-29 00:00:00.0\tR&B\t2\t5PIveStlGgjVL54GpVcqxr\n271470\tFetty Wap\tMy Way\tUnited States\t2015-10-17 00:00:00.0\tRap/Hip-Hop\t16\t7zpZQzTwWBN0eOsmb4WPH3\n76065\tElvis Presley\tMy Way\tUnited States\t1977-12-11 00:00:00.0\tRock & Roll\t75\t7ffB6ngbE3C6G050SUclvv\n272079\tFetty Wap\tMy Way\tUnited States\t2015-11-28 00:00:00.0\tRap/Hip-Hop\t35\t7zpZQzTwWBN0eOsmb4WPH3\n39795\tBrook Benton\tMy Way\tUnited States\t1970-05-23 00:00:00.0\tSoul\t72\t0fcvrAmbVEy6V9szoadvNY\n216178\tUsher\tMy Way\tUnited States\t1998-11-14 00:00:00.0\tR&B\t29\t5PIveStlGgjVL54GpVcqxr\n263218\tFetty Wap\tMy Way\tUnited States\t2015-07-18 00:00:00.0\tRap/Hip-Hop\t98\t7zpZQzTwWBN0eOsmb4WPH3\n77018\tElvis Presley\tMy Way\tUnited States\t1978-01-21 00:00:00.0\tRock & Roll\t65\t7ffB6ngbE3C6G050SUclvv\n38950\tFrank Sinatra\tMy Way\tUnited States\t1969-04-26 00:00:00.0\tTraditional Pop\t30\t0mdefZ4yfFr2DehHGIqLCX\n263600\tFetty Wap\tMy Way\tUnited States\t2015-08-15 00:00:00.0\tRap/Hip-Hop\t8\t7zpZQzTwWBN0eOsmb4WPH3\n210977\tUsher\tMy Way\tUnited States\t1998-03-10 00:00:00.0\tR&B\t6\t5PIveStlGgjVL54GpVcqxr\n210696\tUsher\tMy Way\tUnited States\t1998-12-09 00:00:00.0\tR&B\t4\t5PIveStlGgjVL54GpVcqxr\n210892\tUsher\tMy Way\tUnited States\t1998-09-26 00:00:00.0\tR&B\t4\t5PIveStlGgjVL54GpVcqxr\n210588\tUsher\tMy Way\tUnited States\t1998-05-09 00:00:00.0\tR&B\t4\t5PIveStlGgjVL54GpVcqxr\n38849\tFrank Sinatra\tMy Way\tUnited States\t1969-04-19 00:00:00.0\tTraditional Pop\t33\t0mdefZ4yfFr2DehHGIqLCX\n199181\tLimp Bizkit\tMy Way\tUnited States\t2001-05-05 00:00:00.0\tMetal\t76\t3oXhBXVfDz63XlmaVqOg3G\n271978\tFetty Wap\tMy Way\tUnited States\t2015-11-21 00:00:00.0\tRap/Hip-Hop\t35\t7zpZQzTwWBN0eOsmb4WPH3\n210789\tUsher\tMy Way\tUnited States\t1998-09-19 00:00:00.0\tR&B\t4\t5PIveStlGgjVL54GpVcqxr\n205835\tLimp Bizkit\tMy Way\tUnited States\t2001-07-07 00:00:00.0\tMetal\t99\t3oXhBXVfDz63XlmaVqOg3G\n263899\tFetty Wap\tMy Way\tUnited States\t2015-05-09 00:00:00.0\tRap/Hip-Hop\t11\t7zpZQzTwWBN0eOsmb4WPH3\n202755\tUsher\tMy Way\tUnited States\t1998-06-27 00:00:00.0\tR&B\t9\t5PIveStlGgjVL54GpVcqxr\n271777\tFetty Wap\tMy Way\tUnited States\t2015-07-11 00:00:00.0\tRap/Hip-Hop\t26\t7zpZQzTwWBN0eOsmb4WPH3\n205735\tLimp Bizkit\tMy Way\tUnited States\t2001-06-30 00:00:00.0\tMetal\t94\t3oXhBXVfDz63XlmaVqOg3G\n76448\tElvis Presley\tMy Way\tUnited States\t1977-10-12 00:00:00.0\tRock & Roll\t30\t7ffB6ngbE3C6G050SUclvv\n210117\tUsher\tMy Way\tUnited States\t1998-01-08 00:00:00.0\tR&B\t3\t5PIveStlGgjVL54GpVcqxr\n210209\tUsher\tMy Way\tUnited States\t1998-08-08 00:00:00.0\tR&B\t3\t5PIveStlGgjVL54GpVcqxr\n215969\tUsher\tMy Way\tUnited States\t1998-10-31 00:00:00.0\tR&B\t20\t5PIveStlGgjVL54GpVcqxr\n216267\tUsher\tMy Way\tUnited States\t1998-11-21 00:00:00.0\tR&B\t31\t5PIveStlGgjVL54GpVcqxr\n199080\tLimp Bizkit\tMy Way\tUnited States\t2001-04-28 00:00:00.0\tMetal\t81\t3oXhBXVfDz63XlmaVqOg3G\n272181\tFetty Wap\tMy Way\tUnited States\t2015-05-12 00:00:00.0\tRap/Hip-Hop\t39\t7zpZQzTwWBN0eOsmb4WPH3\n263420\tFetty Wap\tMy Way\tUnited States\t2015-01-08 00:00:00.0\tRap/Hip-Hop\t87\t7zpZQzTwWBN0eOsmb4WPH3\n205635\tLimp Bizkit\tMy Way\tUnited States\t2001-06-23 00:00:00.0\tMetal\t90\t3oXhBXVfDz63XlmaVqOg3G\n199278\tLimp Bizkit\tMy Way\tUnited States\t2001-12-05 00:00:00.0\tMetal\t76\t3oXhBXVfDz63XlmaVqOg3G\n210313\tUsher\tMy Way\tUnited States\t1998-08-15 00:00:00.0\tR&B\t2\t5PIveStlGgjVL54GpVcqxr\n271275\tFetty Wap\tMy Way\tUnited States\t2015-03-10 00:00:00.0\tRap/Hip-Hop\t15\t7zpZQzTwWBN0eOsmb4WPH3\n211079\tUsher\tMy Way\tUnited States\t1998-10-10 00:00:00.0\tR&B\t8\t5PIveStlGgjVL54GpVcqxr\n215884\tUsher\tMy Way\tUnited States\t1998-10-24 00:00:00.0\tR&B\t19\t5PIveStlGgjVL54GpVcqxr\n199376\tLimp Bizkit\tMy Way\tUnited States\t2001-05-19 00:00:00.0\tMetal\t75\t3oXhBXVfDz63XlmaVqOg3G\n"}]},"apps":[],"jobName":"paragraph_1526458718686_963209732","id":"20180514-122510_1261816193","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8808","user":"admin","dateFinished":"2018-05-16T09:09:31+0000","dateStarted":"2018-05-16T09:09:30+0000"},{"text":"%md\nAs you noticed, there is several different songs titled as \"**My Way**\"\n\n","dateUpdated":"2018-05-16T09:09:42+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":6,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>As you noticed, there is several different songs titled as &ldquo;<strong>My Way</strong>&rdquo;</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718686_963209732","id":"20180514-122834_253481047","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8809","user":"admin","dateFinished":"2018-05-16T09:02:00+0000","dateStarted":"2018-05-16T09:02:00+0000"},{"text":"%spark2.pyspark\n\nz.show(billboardDF.filter(billboardDF['title'] == \"My Way\").select('artist').distinct())","dateUpdated":"2018-05-16T09:09:38+0000","config":{"colWidth":6,"editorMode":"ace/mode/python","results":{"0":{"graph":{"mode":"table","height":238,"optionOpen":false}}},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"artist\nElvis Presley\nFrank Sinatra\nUsher\nLimp Bizkit\nFetty Wap\nBrook Benton\n"}]},"apps":[],"jobName":"paragraph_1526458718686_963209732","id":"20180507-153547_48128007","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8810","user":"admin","dateFinished":"2018-05-16T09:09:40+0000","dateStarted":"2018-05-16T09:09:38+0000"},{"text":"%md\n\nClearly, \"**track_id**\" column is unique for every different song.\n\n\"**track_id**\" is unique \"Spotify ID\" for songs. (We will speak on this\tdetailedly later.)","dateUpdated":"2018-05-16T09:09:48+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Clearly, &ldquo;<strong>track_id</strong>&rdquo; column is unique for every different song.</p>\n<p>&ldquo;<strong>track_id</strong>&rdquo; is unique &ldquo;Spotify ID&rdquo; for songs. (We will speak on this detailedly later.)</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718687_962824983","id":"20180514-121806_1750246274","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8811","user":"admin","dateFinished":"2018-05-16T09:02:00+0000","dateStarted":"2018-05-16T09:02:00+0000"},{"text":"%md\nBut if you remember, we saw some null values on \"**track_id**\" column when we loaded the dataset.\n\nLet's check out the null values first.\n","dateUpdated":"2018-05-16T09:09:53+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>But if you remember, we saw some null values on &ldquo;<strong>track_id</strong>&rdquo; column when we loaded the dataset.</p>\n<p>Let's check out the null values first.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718687_962824983","id":"20180514-131812_406581948","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8812","user":"admin","dateFinished":"2018-05-16T09:02:01+0000","dateStarted":"2018-05-16T09:02:01+0000"},{"text":"%md\n\nFor checking out the null values, we can use `isNull` and `isNotNull` methods of spark dataframes.","dateUpdated":"2018-05-16T09:09:57+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":6,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>For checking out the null values, we can use <code>isNull</code> and <code>isNotNull</code> methods of spark dataframes.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718687_962824983","id":"20180514-132200_852486232","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8813","user":"admin","dateFinished":"2018-05-16T09:02:01+0000","dateStarted":"2018-05-16T09:02:01+0000"},{"text":"%md\nAlso, we can use `isnull` function from pyspark sql functions.\n","dateUpdated":"2018-05-16T09:10:00+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":6,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Also, we can use <code>isnull</code> function from pyspark sql functions.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718687_962824983","id":"20180514-132331_147977982","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8814","user":"admin","dateFinished":"2018-05-16T09:02:01+0000","dateStarted":"2018-05-16T09:02:01+0000"},{"text":"%spark2.pyspark\n\nprint(billboardDF.filter(billboardDF[\"track_id\"].isNull()).count())\n\nprint(billboardDF.filter(billboardDF[\"track_id\"].isNotNull()).count())","dateUpdated":"2018-05-16T09:10:02+0000","config":{"colWidth":6,"editorMode":"ace/mode/python","results":{"0":{"graph":{"mode":"table","height":250,"optionOpen":false}}},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"40170\n256818\n"}]},"apps":[],"jobName":"paragraph_1526458718687_962824983","id":"20180514-123709_33922283","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8815","user":"admin","dateFinished":"2018-05-16T09:10:06+0000","dateStarted":"2018-05-16T09:10:03+0000"},{"text":"%spark2.pyspark\n\nfrom pyspark.sql.functions import *\n\nbillboardDF\\\n.select(isnull(\"track_id\").alias(\"isNull\"))\\\n.groupBy('isNull').count().show()","dateUpdated":"2018-05-16T09:10:07+0000","config":{"colWidth":6,"editorMode":"ace/mode/python","results":{"0":{"graph":{"mode":"table","height":248,"optionOpen":false}}},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+------+\n|isNull| count|\n+------+------+\n|  true| 40170|\n| false|256818|\n+------+------+\n\n"}]},"apps":[],"jobName":"paragraph_1526458718687_962824983","id":"20180514-123912_514436083","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8816","user":"admin","dateFinished":"2018-05-16T09:10:11+0000","dateStarted":"2018-05-16T09:10:08+0000"},{"text":"%md\n\nAlso, you can use `na.drop` function for omiting rows with null values","dateUpdated":"2018-05-16T09:10:19+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Also, you can use <code>na.drop</code> function for omiting rows with null values</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718687_962824983","id":"20180515-021902_647031629","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8817","user":"admin","dateFinished":"2018-05-16T09:02:03+0000","dateStarted":"2018-05-16T09:02:03+0000"},{"text":"%spark2.pyspark\n\nbillboardDF.na.drop(subset=[\"track_id\"]).count()","dateUpdated":"2018-05-16T09:10:27+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"256818\n"}]},"apps":[],"jobName":"paragraph_1526458718687_962824983","id":"20180515-021523_894602772","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8818","user":"admin","dateFinished":"2018-05-16T09:10:30+0000","dateStarted":"2018-05-16T09:10:28+0000"},{"text":"%md\n\nGoing back to the question, due to null values, we can not use \"**track_id**\" column for answer we are looking for.\n\nSo, we need to create unique column.\n\nConcatenating **artist name** and **song title** will give us the unique column values.","dateUpdated":"2018-05-16T09:10:39+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Going back to the question, due to null values, we can not use &ldquo;<strong>track_id</strong>&rdquo; column for answer we are looking for.</p>\n<p>So, we need to create unique column.</p>\n<p>Concatenating <strong>artist name</strong> and <strong>song title</strong> will give us the unique column values.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718688_948589273","id":"20180514-132054_1521641759","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8819","user":"admin","dateFinished":"2018-05-16T09:02:04+0000","dateStarted":"2018-05-16T09:02:04+0000"},{"text":"%md\nFor adding new column, we can use `withColumn` method.\n\nFor concatenating, we will take advantage of `concat` method.\n\nPlease note that, `concat` accepts only Column types. Therefore we will also use `lit` method for converting string to Column type.","dateUpdated":"2018-05-16T09:10:44+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>For adding new column, we can use <code>withColumn</code> method.</p>\n<p>For concatenating, we will take advantage of <code>concat</code> method.</p>\n<p>Please note that, <code>concat</code> accepts only Column types. Therefore we will also use <code>lit</code> method for converting string to Column type.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718688_948589273","id":"20180514-135715_420008738","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8820","user":"admin","dateFinished":"2018-05-16T09:02:04+0000","dateStarted":"2018-05-16T09:02:04+0000"},{"text":"%spark2.pyspark\n\nbillboardDF = billboardDF.withColumn(\"artist_song\",concat(billboardDF.artist, lit(\" - \"), billboardDF.title ))\n\nz.show(billboardDF.limit(10))","user":"admin","dateUpdated":"2018-05-16T09:11:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526461857732_-486253222","id":"20180516-091057_1455081206","dateCreated":"2018-05-16T09:10:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20958","dateFinished":"2018-05-16T09:11:13+0000","dateStarted":"2018-05-16T09:11:11+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\tartist\ttitle\tcountry\tdate\tgenre\trank\ttrack_id\tartist_song\n170115\tRhythm Syndicate\tI Wanna Make Love To You\tUnited States\t1992-10-17 00:00:00.0\tR&B\t75\tnull\tRhythm Syndicate - I Wanna Make Love To You\n170309\tColor Me Badd\tForever Love\tUnited States\t1992-10-31 00:00:00.0\tR&B\t16\tnull\tColor Me Badd - Forever Love\n170729\tMC Serch\tHere It Comes\tUnited States\t1992-11-28 00:00:00.0\tRap/Hip-Hop\t76\tnull\tMC Serch - Here It Comes\n170746\tPatty Smyth\tSometimes Love Just Ain't Enough\tUnited States\t1992-11-28 00:00:00.0\tRock\t11\tnull\tPatty Smyth - Sometimes Love Just Ain't Enough\n170891\tPajama Party\tYo No Se\tUnited States\t1989-07-22 00:00:00.0\tPop\t93\t4tNn9trTmARqzz6NuwMMKn\tPajama Party - Yo No Se\n170950\tThe Call\tLet The Day Begin\tUnited States\t1989-07-22 00:00:00.0\tRock\t91\t59YYheZHNWi44imVPTp8hX\tThe Call - Let The Day Begin\n171187\tDebbie Gibson\tNo More Rhyme\tUnited States\t1989-12-08 00:00:00.0\tPop\t17\t6K34QHQLwxyRlvEZMS7XUf\tDebbie Gibson - No More Rhyme\n171359\tUnderworld\tStand Up\tEngland\t1989-08-26 00:00:00.0\tHouse/Electronic/Trance\t95\tnull\tUnderworld - Stand Up\n171507\tKatrina & The Waves\tThat's The Way\tEngland\t1989-02-09 00:00:00.0\tRock\t24\tnull\tKatrina & The Waves - That's The Way\n171577\tStevie B\tIn My Eyes\tUnited States\t1989-09-09 00:00:00.0\tPop\t71\t2I8yCOvR8g4oHkAMY5Mmd8\tStevie B - In My Eyes\n"}]}},{"text":"%md\n\nNow, we can answer the question. \n\nHow many different songs does the dataset contains?\n\nLet's use `distinct` method on our new column and find out the answer.","dateUpdated":"2018-05-16T09:11:25+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Now, we can answer the question.</p>\n<p>How many different songs does the dataset contains?</p>\n<p>Let's use <code>distinct</code> method on our new column and find out the answer.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718688_948589273","id":"20180514-142044_1154069547","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8822","user":"admin","dateFinished":"2018-05-16T09:02:06+0000","dateStarted":"2018-05-16T09:02:06+0000"},{"text":"%spark2.pyspark\n\nbillboardDF.select(\"artist_song\").distinct().count()","dateUpdated":"2018-05-16T09:11:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"26066\n"}]},"apps":[],"jobName":"paragraph_1526458718688_948589273","id":"20180508-095738_2105876542","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8823","user":"admin","dateFinished":"2018-05-16T09:11:36+0000","dateStarted":"2018-05-16T09:11:30+0000"},{"text":"%md\n\n### Bonus \n\nWhat is the percentage that spotify streamable song contained in the dataset?","dateUpdated":"2018-05-16T09:11:43+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Bonus</h3>\n<p>What is the percentage that spotify streamable song contained in the dataset?</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718688_948589273","id":"20180514-142936_1562181097","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8824","user":"admin","dateFinished":"2018-05-16T09:02:08+0000","dateStarted":"2018-05-16T09:02:08+0000"},{"text":"%md\n\nWe said that \"**track_id**\" is unique \"Spotify ID\" for songs.\n\nWe used advantages of \"**Spotify API**\" like determining genres. That's why there is a \"**track_id**\" column.\n\nWith \"**track_id**\" value you can find a song on Spotify (https://open.spotify.com/track/track_id)","dateUpdated":"2018-05-16T09:11:47+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>We said that &ldquo;<strong>track_id</strong>&rdquo; is unique &ldquo;Spotify ID&rdquo; for songs.</p>\n<p>We used advantages of &ldquo;<strong>Spotify API</strong>&rdquo; like determining genres. That's why there is a &ldquo;<strong>track_id</strong>&rdquo; column.</p>\n<p>With &ldquo;<strong>track_id</strong>&rdquo; value you can find a song on Spotify (https://open.spotify.com/track/track_id)</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718688_948589273","id":"20180515-022947_771959364","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8825","user":"admin","dateFinished":"2018-05-16T09:02:09+0000","dateStarted":"2018-05-16T09:02:09+0000"},{"text":"%md\n\nLet's calculate the ratio of the dataset contains streamable Spotify songs to does not","dateUpdated":"2018-05-16T09:12:34+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Let's calculate the ratio of the dataset contains streamable Spotify songs to does not</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718689_948204525","id":"20180515-023801_1829091607","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8826","user":"admin","dateFinished":"2018-05-16T09:02:10+0000","dateStarted":"2018-05-16T09:02:10+0000"},{"text":"%spark2.pyspark\n\nallSongsCount = billboardDF.select(\"artist_song\").distinct().count()\nstreamableSongsCount = billboardDF.filter(billboardDF[\"track_id\"].isNotNull()).select(\"artist_song\").distinct().count()","dateUpdated":"2018-05-16T09:12:37+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1526458718689_948204525","id":"20180514-133258_937787003","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8827","user":"admin","dateFinished":"2018-05-16T09:12:48+0000","dateStarted":"2018-05-16T09:12:37+0000"},{"text":"%spark2.pyspark\n\nprint(streamableSongsCount/float(allSongsCount)*100)","dateUpdated":"2018-05-16T09:12:54+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"82.3486534182\n"}]},"apps":[],"jobName":"paragraph_1526458718689_948204525","id":"20180515-024752_1584611745","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8828","user":"admin","dateFinished":"2018-05-16T09:12:54+0000","dateStarted":"2018-05-16T09:12:54+0000"},{"text":"%md\n\n### Question 3\n\nHow has the genres rise and fall over time?","dateUpdated":"2018-05-16T09:13:06+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Question 3</h3>\n<p>How has the genres rise and fall over time?</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718689_948204525","id":"20180515-024847_29800280","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8829","user":"admin","dateFinished":"2018-05-16T09:02:11+0000","dateStarted":"2018-05-16T09:02:11+0000"},{"text":"%md\n\nLet's look at how a genre's occurrences and rank on the Hot 100 chart changed over time. \n\nTo do so, Let's create a new column called \"**score**\" which is contains values 1 to 100.","dateUpdated":"2018-05-16T09:13:13+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Let's look at how a genre's occurrences and rank on the Hot 100 chart changed over time.</p>\n<p>To do so, Let's create a new column called &ldquo;<strong>score</strong>&rdquo; which is contains values 1 to 100.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718689_948204525","id":"20180515-025457_290167769","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8830","user":"admin","dateFinished":"2018-05-16T09:02:12+0000","dateStarted":"2018-05-16T09:02:12+0000"},{"text":"%spark2.pyspark\n\nbillboardDF = billboardDF.withColumn(\"score\", 101 - billboardDF.rank)\nz.show(billboardDF.limit(10))","dateUpdated":"2018-05-16T09:13:21+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\tartist\ttitle\tcountry\tdate\tgenre\trank\ttrack_id\tartist_song\tscore\n170115\tRhythm Syndicate\tI Wanna Make Love To You\tUnited States\t1992-10-17 00:00:00.0\tR&B\t75\tnull\tRhythm Syndicate - I Wanna Make Love To You\t26\n170309\tColor Me Badd\tForever Love\tUnited States\t1992-10-31 00:00:00.0\tR&B\t16\tnull\tColor Me Badd - Forever Love\t85\n170729\tMC Serch\tHere It Comes\tUnited States\t1992-11-28 00:00:00.0\tRap/Hip-Hop\t76\tnull\tMC Serch - Here It Comes\t25\n170746\tPatty Smyth\tSometimes Love Just Ain't Enough\tUnited States\t1992-11-28 00:00:00.0\tRock\t11\tnull\tPatty Smyth - Sometimes Love Just Ain't Enough\t90\n170891\tPajama Party\tYo No Se\tUnited States\t1989-07-22 00:00:00.0\tPop\t93\t4tNn9trTmARqzz6NuwMMKn\tPajama Party - Yo No Se\t8\n170950\tThe Call\tLet The Day Begin\tUnited States\t1989-07-22 00:00:00.0\tRock\t91\t59YYheZHNWi44imVPTp8hX\tThe Call - Let The Day Begin\t10\n171187\tDebbie Gibson\tNo More Rhyme\tUnited States\t1989-12-08 00:00:00.0\tPop\t17\t6K34QHQLwxyRlvEZMS7XUf\tDebbie Gibson - No More Rhyme\t84\n171359\tUnderworld\tStand Up\tEngland\t1989-08-26 00:00:00.0\tHouse/Electronic/Trance\t95\tnull\tUnderworld - Stand Up\t6\n171507\tKatrina & The Waves\tThat's The Way\tEngland\t1989-02-09 00:00:00.0\tRock\t24\tnull\tKatrina & The Waves - That's The Way\t77\n171577\tStevie B\tIn My Eyes\tUnited States\t1989-09-09 00:00:00.0\tPop\t71\t2I8yCOvR8g4oHkAMY5Mmd8\tStevie B - In My Eyes\t30\n"}]},"apps":[],"jobName":"paragraph_1526458718689_948204525","id":"20180515-024328_1325895613","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8831","user":"admin","dateFinished":"2018-05-16T09:13:23+0000","dateStarted":"2018-05-16T09:13:22+0000"},{"text":"%md\n\nNow, we can calculate total popularity score of each genre.\n\nLet's group our data by genre column and then aggregate score column. For doing this we will use `groupBy` function of dataframes and `agg` function of Grouped Data type.","dateUpdated":"2018-05-16T09:13:31+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Now, we can calculate total popularity score of each genre.</p>\n<p>Let's group our data by genre column and then aggregate score column. For doing this we will use <code>groupBy</code> function of dataframes and <code>agg</code> function of Grouped Data type.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718689_948204525","id":"20180515-031023_438623371","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8832","user":"admin","dateFinished":"2018-05-16T09:02:13+0000","dateStarted":"2018-05-16T09:02:13+0000"},{"text":"%spark2.pyspark\n\nz.show(\n    billboardDF\n    .groupBy('genre')\n    .agg(sum('score').alias('totalScore'))\n)","dateUpdated":"2018-05-16T09:13:34+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{},"keys":[{"name":"genre","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"totalScore","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"genre\ttotalScore\nSka/Reggae/Dancehall\t81147\nRap/Hip-Hop\t1241504\nLatin\t99510\nMetal\t157766\nRock\t3864924\nJazz\t135256\nHouse/Electronic/Trance\t228337\nFolk\t474896\nBlues\t109753\nR&B\t1380958\nTraditional Pop\t673970\nRock & Roll\t772852\nPop\t2636644\nPunk\t104933\nSoul\t1929110\nCountry\t1192178\n"}]},"apps":[],"jobName":"paragraph_1526458718689_948204525","id":"20180507-152421_2072126537","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8833","user":"admin","dateFinished":"2018-05-16T09:13:37+0000","dateStarted":"2018-05-16T09:13:34+0000"},{"text":"%spark2.pyspark\n\nbillboardDF.groupBy('genre')","dateUpdated":"2018-05-16T09:13:45+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<pyspark.sql.group.GroupedData object at 0x1421ad0>\n"}]},"apps":[],"jobName":"paragraph_1526458718690_949358771","id":"20180516-061941_2060616298","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8834","user":"admin","dateFinished":"2018-05-16T09:13:45+0000","dateStarted":"2018-05-16T09:13:45+0000"},{"text":"%md\n\nPlease note that, groupBy function returns a \"**GroupedData Object**\"\n\n\"**GroupedData Object**\" has set of methods for aggregations like `count`, `sum`, `avg`, `max`, `min`.","dateUpdated":"2018-05-16T09:13:51+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Please note that, groupBy function returns a &ldquo;<strong>GroupedData Object</strong>&rdquo;</p>\n<p>&ldquo;<strong>GroupedData Object</strong>&rdquo; has set of methods for aggregations like <code>count</code>, <code>sum</code>, <code>avg</code>, <code>max</code>, <code>min</code>.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718690_949358771","id":"20180516-062032_874228465","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8835","user":"admin","dateFinished":"2018-05-16T09:02:15+0000","dateStarted":"2018-05-16T09:02:15+0000"},{"text":"%md\n\nYou can sort the result by using `sort` function.","dateUpdated":"2018-05-16T09:13:56+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":6,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>You can sort the result by using <code>sort</code> function.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718690_949358771","id":"20180515-031926_1879346994","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8836","user":"admin","dateFinished":"2018-05-16T09:02:16+0000","dateStarted":"2018-05-16T09:02:16+0000"},{"text":"%md\n\nNote that, `orderBy` is a alias for sort","dateUpdated":"2018-05-16T09:13:58+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":true},"colWidth":6,"editorMode":"ace/mode/scala","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Note that, <code>orderBy</code> is a alias for sort</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718690_949358771","id":"20180515-032209_1411291266","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8837","user":"admin","dateFinished":"2018-05-16T09:02:17+0000","dateStarted":"2018-05-16T09:02:17+0000"},{"text":"%spark2.pyspark\n\nz.show(\n    billboardDF\n    .groupBy('genre')\n    .agg(sum('score').alias('totalScore'))\n    .sort('totalScore', ascending=False)\n)","dateUpdated":"2018-05-16T09:14:00+0000","config":{"editorSetting":{"language":"python"},"colWidth":6,"editorMode":"ace/mode/python","editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{},"keys":[{"name":"genre","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"totalScore","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"genre\ttotalScore\nRock\t3864924\nPop\t2636644\nSoul\t1929110\nR&B\t1380958\nRap/Hip-Hop\t1241504\nCountry\t1192178\nRock & Roll\t772852\nTraditional Pop\t673970\nFolk\t474896\nHouse/Electronic/Trance\t228337\nMetal\t157766\nJazz\t135256\nBlues\t109753\nPunk\t104933\nLatin\t99510\nSka/Reggae/Dancehall\t81147\n"}]},"apps":[],"jobName":"paragraph_1526458718690_949358771","id":"20180515-032107_729378346","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8838","user":"admin","dateFinished":"2018-05-16T09:14:03+0000","dateStarted":"2018-05-16T09:14:00+0000"},{"text":"%spark2.pyspark\n\nz.show(\n    billboardDF\n    .groupBy('genre')\n    .agg(sum('score').alias('totalScore'))\n    .orderBy([\"totalScore\",\"genre\"],ascending=[1,0])\n)","dateUpdated":"2018-05-16T09:14:06+0000","config":{"editorSetting":{"language":"python"},"colWidth":6,"editorMode":"ace/mode/python","editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{},"keys":[{"name":"genre","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"totalScore","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"genre\ttotalScore\nSka/Reggae/Dancehall\t81147\nLatin\t99510\nPunk\t104933\nBlues\t109753\nJazz\t135256\nMetal\t157766\nHouse/Electronic/Trance\t228337\nFolk\t474896\nTraditional Pop\t673970\nRock & Roll\t772852\nCountry\t1192178\nRap/Hip-Hop\t1241504\nR&B\t1380958\nSoul\t1929110\nPop\t2636644\nRock\t3864924\n"}]},"apps":[],"jobName":"paragraph_1526458718690_949358771","id":"20180515-032240_1381050517","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8839","user":"admin","dateFinished":"2018-05-16T09:14:09+0000","dateStarted":"2018-05-16T09:14:07+0000"},{"text":"%md\n\nYou can visualize the result with \"**Zeppelin**\"","dateUpdated":"2018-05-16T09:14:23+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>You can visualize the result with &ldquo;<strong>Zeppelin</strong>&rdquo;</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718690_949358771","id":"20180515-032534_2111106982","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8840","user":"admin","dateFinished":"2018-05-16T09:02:18+0000","dateStarted":"2018-05-16T09:02:18+0000"},{"text":"%spark2.pyspark\n\nz.show(\n    billboardDF\n    .groupBy('genre')\n    .agg(sum('score').alias('totalScore'))\n)","dateUpdated":"2018-05-16T09:14:25+0000","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{},"keys":[{"name":"genre","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"totalScore","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"genre\ttotalScore\nSka/Reggae/Dancehall\t81147\nRap/Hip-Hop\t1241504\nLatin\t99510\nMetal\t157766\nRock\t3864924\nJazz\t135256\nHouse/Electronic/Trance\t228337\nFolk\t474896\nBlues\t109753\nR&B\t1380958\nTraditional Pop\t673970\nRock & Roll\t772852\nPop\t2636644\nPunk\t104933\nSoul\t1929110\nCountry\t1192178\n"}]},"apps":[],"jobName":"paragraph_1526458718691_948974022","id":"20180515-032502_2002358254","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8841","user":"admin","dateFinished":"2018-05-16T09:14:28+0000","dateStarted":"2018-05-16T09:14:25+0000"},{"text":"%md\n\nNow, let's look at the change over the years.\n\nFirst, we need to create \"**year**\" column.","dateUpdated":"2018-05-16T09:14:35+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Now, let's look at the change over the years.</p>\n<p>First, we need to create &ldquo;<strong>year</strong>&rdquo; column.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718691_948974022","id":"20180515-033423_1053696187","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8842","user":"admin","dateFinished":"2018-05-16T09:02:19+0000","dateStarted":"2018-05-16T09:02:19+0000"},{"text":"%spark2.pyspark\n\nbillboardDF = billboardDF.withColumn(\"year\", date_format(to_date(billboardDF.date, \"dd/MMM/yyyy\"), \"yyyy\"))\n\nz.show(billboardDF.limit(10))","dateUpdated":"2018-05-16T09:14:39+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\tartist\ttitle\tcountry\tdate\tgenre\trank\ttrack_id\tartist_song\tscore\tyear\n170115\tRhythm Syndicate\tI Wanna Make Love To You\tUnited States\t1992-10-17 00:00:00.0\tR&B\t75\tnull\tRhythm Syndicate - I Wanna Make Love To You\t26\t1992\n170309\tColor Me Badd\tForever Love\tUnited States\t1992-10-31 00:00:00.0\tR&B\t16\tnull\tColor Me Badd - Forever Love\t85\t1992\n170729\tMC Serch\tHere It Comes\tUnited States\t1992-11-28 00:00:00.0\tRap/Hip-Hop\t76\tnull\tMC Serch - Here It Comes\t25\t1992\n170746\tPatty Smyth\tSometimes Love Just Ain't Enough\tUnited States\t1992-11-28 00:00:00.0\tRock\t11\tnull\tPatty Smyth - Sometimes Love Just Ain't Enough\t90\t1992\n170891\tPajama Party\tYo No Se\tUnited States\t1989-07-22 00:00:00.0\tPop\t93\t4tNn9trTmARqzz6NuwMMKn\tPajama Party - Yo No Se\t8\t1989\n170950\tThe Call\tLet The Day Begin\tUnited States\t1989-07-22 00:00:00.0\tRock\t91\t59YYheZHNWi44imVPTp8hX\tThe Call - Let The Day Begin\t10\t1989\n171187\tDebbie Gibson\tNo More Rhyme\tUnited States\t1989-12-08 00:00:00.0\tPop\t17\t6K34QHQLwxyRlvEZMS7XUf\tDebbie Gibson - No More Rhyme\t84\t1989\n171359\tUnderworld\tStand Up\tEngland\t1989-08-26 00:00:00.0\tHouse/Electronic/Trance\t95\tnull\tUnderworld - Stand Up\t6\t1989\n171507\tKatrina & The Waves\tThat's The Way\tEngland\t1989-02-09 00:00:00.0\tRock\t24\tnull\tKatrina & The Waves - That's The Way\t77\t1989\n171577\tStevie B\tIn My Eyes\tUnited States\t1989-09-09 00:00:00.0\tPop\t71\t2I8yCOvR8g4oHkAMY5Mmd8\tStevie B - In My Eyes\t30\t1989\n"}]},"apps":[],"jobName":"paragraph_1526458718691_948974022","id":"20180507-134605_1985368613","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8843","user":"admin","dateFinished":"2018-05-16T09:14:41+0000","dateStarted":"2018-05-16T09:14:39+0000"},{"text":"%spark2.pyspark\n\nz.show(\n    billboardDF\n    .groupBy(['genre','year'])\n    .agg(sum('score').alias('score'))\n)","dateUpdated":"2018-05-16T09:15:01+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false,"setting":{"lineChart":{"forceY":false,"lineWithFocus":true}},"commonSetting":{},"keys":[{"name":"year","index":1,"aggr":"sum"}],"groups":[{"name":"genre","index":0,"aggr":"sum"}],"values":[{"name":"score","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"genre\tyear\tscore\nPop\t1994\t35886\nRock\t1962\t8371\nLatin\t1989\t2462\nRock & Roll\t2003\t8\nSoul\t1980\t60121\nMetal\t2009\t6530\nR&B\t2012\t14012\nPunk\t2013\t3748\nBlues\t1958\t3403\nMetal\t2010\t1454\nTraditional Pop\t2006\t2\nPop\t2014\t126678\nR&B\t2014\t8438\nRap/Hip-Hop\t2016\t47722\nRock\t1975\t87794\nSoul\t1988\t16506\nLatin\t1991\t2778\nRap/Hip-Hop\t1994\t41286\nBlues\t1966\t2923\nMetal\t1993\t2591\nLatin\t1985\t869\nSoul\t1958\t6622\nRock & Roll\t1973\t4617\nBlues\t1988\t1382\nHouse/Electronic/Trance\t1964\t525\nRock\t2003\t20243\nBlues\t1971\t1431\nMetal\t1991\t2318\nRock\t2015\t1427\nPunk\t1983\t1112\nFolk\t2011\t779\nRap/Hip-Hop\t1996\t41385\nLatin\t1987\t2286\nCountry\t1972\t6849\nFolk\t2006\t2384\nRock\t1967\t100125\nFolk\t1983\t6020\nR&B\t1967\t408\nSoul\t1989\t11415\nMetal\t1986\t31\nCountry\t1979\t15641\nR&B\t1982\t751\nBlues\t1989\t1509\nSka/Reggae/Dancehall\t1966\t20\nPunk\t2008\t6347\nRock & Roll\t1967\t20633\nJazz\t1977\t1714\nSka/Reggae/Dancehall\t2012\t23\nR&B\t1999\t69030\nPunk\t1968\t19\nMetal\t1982\t144\nRock\t1989\t117048\nPop\t2010\t117877\nTraditional Pop\t1968\t20682\nPop\t1972\t30293\nRap/Hip-Hop\t1988\t7232\nLatin\t1997\t1268\nTraditional Pop\t1984\t843\nR&B\t1996\t79833\nRap/Hip-Hop\t1999\t23826\nSka/Reggae/Dancehall\t1976\t224\nRock & Roll\t1998\t12\nTraditional Pop\t1980\t9850\nFolk\t1996\t18864\nFolk\t1960\t3125\nRock\t2013\t3435\nPop\t1970\t26352\nRock\t1984\t150923\nPop\t1983\t22140\nBlues\t1994\t31\nR&B\t1994\t72522\nRock\t1996\t48041\nRock\t2002\t28587\nRap/Hip-Hop\t2009\t46791\nPunk\t1974\t464\nHouse/Electronic/Trance\t1962\t359\nFolk\t1965\t7567\nRock\t1982\t159108\nLatin\t1990\t1982\nRock & Roll\t2016\t134\nSka/Reggae/Dancehall\t1993\t11105\nRap/Hip-Hop\t1998\t47138\nRock & Roll\t1988\t1303\nR&B\t1968\t453\nPunk\t1970\t16\nMetal\t2005\t8689\nTraditional Pop\t1987\t3507\nHouse/Electronic/Trance\t1974\t1460\nPunk\t1980\t736\nRock & Roll\t1958\t30182\nMetal\t1973\t4527\nLatin\t1999\t6994\nHouse/Electronic/Trance\t2006\t1129\nRap/Hip-Hop\t1986\t1899\nBlues\t1981\t1759\nCountry\t2001\t47921\nPunk\t2012\t1161\nHouse/Electronic/Trance\t2007\t116\nRap/Hip-Hop\t1959\t301\nSoul\t1996\t1723\nJazz\t1997\t584\nSoul\t2005\t62\nPunk\t1993\t3\nRock\t1987\t140920\nRock & Roll\t1978\t2348\nHouse/Electronic/Trance\t1970\t629\nSoul\t1959\t24429\nPop\t1980\t10499\nRap/Hip-Hop\t1993\t49604\nTraditional Pop\t1971\t9853\nRock\t1998\t28561\nTraditional Pop\t1969\t15650\nFolk\t1992\t5206\nJazz\t1963\t8246\nCountry\t1969\t11952\nSoul\t1987\t28259\nSoul\t1986\t37590\nPop\t2004\t50332\nSoul\t2007\t1640\nPunk\t1988\t1131\nBlues\t1965\t1416\nPop\t2007\t80672\nCountry\t2016\t22044\nRock & Roll\t1979\t2204\nRap/Hip-Hop\t1991\t21083\nPunk\t2006\t14814\nLatin\t2002\t6681\nHouse/Electronic/Trance\t1999\t4061\nSka/Reggae/Dancehall\t2002\t2062\nPunk\t1991\t697\nHouse/Electronic/Trance\t1989\t5928\nTraditional Pop\t1962\t62147\nRock\t1980\t128395\nRock\t1985\t160651\nR&B\t2002\t62855\nBlues\t1969\t3326\nMetal\t1972\t1626\nCountry\t1978\t10014\nSoul\t2001\t3488\nTraditional Pop\t1966\t25379\nLatin\t1986\t898\nBlues\t1984\t128\nTraditional Pop\t2005\t273\nFolk\t1967\t7448\nMetal\t2003\t22336\nCountry\t1985\t1057\nPop\t2002\t49707\nRock\t1992\t68957\nCountry\t1997\t9450\nPunk\t2001\t942\nLatin\t1995\t3333\nRock & Roll\t1989\t1575\nTraditional Pop\t1970\t9025\nPop\t2011\t127626\nLatin\t1992\t4313\nJazz\t2000\t269\nPop\t1992\t46315\nR&B\t2007\t39111\nPop\t1971\t28202\nCountry\t1986\t1343\nHouse/Electronic/Trance\t2003\t144\nR&B\t1991\t45103\nSka/Reggae/Dancehall\t2016\t172\nHouse/Electronic/Trance\t1968\t816\nFolk\t1990\t3884\nTraditional Pop\t2009\t299\nLatin\t2015\t377\nRock\t1993\t58962\nJazz\t1975\t2603\nRap/Hip-Hop\t1995\t39732\nJazz\t1989\t1128\nSka/Reggae/Dancehall\t1963\t565\nRock\t1983\t168849\nTraditional Pop\t1991\t2015\nLatin\t2013\t434\nRock & Roll\t1982\t4098\nR&B\t1976\t60\nJazz\t1966\t5512\nJazz\t1981\t6115\nSoul\t1983\t35469\nCountry\t1964\t6991\nCountry\t1995\t2667\nFolk\t1962\t5252\nPop\t1967\t15042\nHouse/Electronic/Trance\t1965\t500\nHouse/Electronic/Trance\t1988\t3716\nPunk\t2016\t453\nRap/Hip-Hop\t2015\t56294\nRock & Roll\t1986\t845\nJazz\t1965\t3700\nHouse/Electronic/Trance\t1994\t8346\nHouse/Electronic/Trance\t1995\t6173\nPunk\t1998\t38\nR&B\t1993\t70504\nMetal\t1989\t2161\nJazz\t1961\t6819\nPunk\t1962\t1562\nJazz\t1972\t716\nPop\t1990\t71314\nFolk\t2015\t3671\nFolk\t1988\t4736\nCountry\t1980\t24280\nCountry\t1973\t18641\nHouse/Electronic/Trance\t1969\t1394\nHouse/Electronic/Trance\t2012\t7720\nFolk\t2012\t4200\nHouse/Electronic/Trance\t2013\t12311\nHouse/Electronic/Trance\t2016\t7983\nJazz\t1962\t12332\nSoul\t1972\t84784\nFolk\t1989\t4798\nTraditional Pop\t1960\t88240\nRock & Roll\t1968\t13836\nRock\t1971\t76826\nSka/Reggae/Dancehall\t1984\t837\nBlues\t1968\t1763\nFolk\t1999\t5069\nPop\t1959\t2906\nSoul\t1997\t3070\nRock\t1968\t86030\nSka/Reggae/Dancehall\t1990\t3383\nFolk\t1959\t3003\nTraditional Pop\t1988\t2653\nPunk\t1999\t753\nR&B\t1975\t250\nSka/Reggae/Dancehall\t2006\t7049\nRock\t2009\t18786\nCountry\t1966\t9343\nJazz\t1958\t2818\nLatin\t1984\t3339\nFolk\t1987\t6804\nFolk\t2013\t8313\nHouse/Electronic/Trance\t2004\t5\nRock\t1981\t133992\nSoul\t2016\t1061\nMetal\t2012\t953\nPop\t1981\t9820\nR&B\t2016\t8080\nSka/Reggae/Dancehall\t1988\t2364\nJazz\t1974\t603\nR&B\t1992\t64763\nHouse/Electronic/Trance\t1991\t14048\nCountry\t2013\t48850\nPunk\t1978\t786\nLatin\t1963\t1456\nPunk\t2002\t2992\nLatin\t2005\t2093\nMetal\t1988\t460\nRock & Roll\t1972\t8859\nTraditional Pop\t1981\t5299\nPop\t1988\t69863\nRock\t1994\t62696\nMetal\t1994\t1616\nFolk\t2008\t4322\nSka/Reggae/Dancehall\t1967\t50\nSka/Reggae/Dancehall\t2001\t3741\nHouse/Electronic/Trance\t2000\t2975\nTraditional Pop\t2014\t56\nBlues\t1976\t3017\nRock\t2011\t7377\nFolk\t1994\t12134\nPop\t1974\t21168\nR&B\t2001\t67615\nSka/Reggae/Dancehall\t2004\t5780\nPunk\t2011\t3216\nCountry\t1962\t16936\nLatin\t2006\t2762\nMetal\t1995\t110\nRock\t1995\t61389\nSka/Reggae/Dancehall\t1964\t2003\nTraditional Pop\t1982\t2490\nSoul\t1999\t459\nPop\t1991\t67604\nRap/Hip-Hop\t2011\t46794\nJazz\t1986\t479\nPunk\t1975\t157\nTraditional Pop\t1958\t43630\nCountry\t1968\t7756\nJazz\t1968\t4740\nJazz\t1973\t1563\nPop\t2015\t122169\nPop\t1965\t8425\nRock\t1977\t113558\nHouse/Electronic/Trance\t1977\t1458\nBlues\t1970\t3641\nSka/Reggae/Dancehall\t2005\t2666\nR&B\t2008\t33526\nLatin\t1988\t4034\nSka/Reggae/Dancehall\t1958\t184\nPunk\t1966\t184\nPop\t1987\t51656\nRock & Roll\t1971\t6804\nPunk\t1982\t1207\nCountry\t1961\t18373\nSoul\t1974\t95095\nSoul\t1985\t51081\nCountry\t2005\t35699\nBlues\t1972\t2906\nFolk\t1975\t22580\nHouse/Electronic/Trance\t1983\t3479\nCountry\t1965\t9678\nBlues\t1961\t11044\nPop\t1977\t22744\nPop\t1958\t1456\nRock & Roll\t1970\t11151\nHouse/Electronic/Trance\t1996\t6770\nTraditional Pop\t1990\t1476\nPop\t2012\t128428\nR&B\t2015\t19683\nR&B\t1969\t66\nCountry\t2000\t51252\nRock & Roll\t1965\t42632\nRock\t1990\t96834\nTraditional Pop\t1979\t7014\nJazz\t1959\t7310\nPop\t1982\t8836\nCountry\t1983\t11811\nHouse/Electronic/Trance\t2009\t1313\nSka/Reggae/Dancehall\t1968\t62\nR&B\t1997\t95177\nMetal\t2000\t9796\nRock\t2012\t7935\nMetal\t2013\t84\nSka/Reggae/Dancehall\t2007\t157\nLatin\t2004\t5\nBlues\t1986\t1442\nMetal\t2007\t7920\nSoul\t2009\t252\nSka/Reggae/Dancehall\t1997\t295\nFolk\t2009\t6\nCountry\t1998\t24182\nRap/Hip-Hop\t1982\t538\nTraditional Pop\t1985\t785\nSka/Reggae/Dancehall\t1989\t604\nSoul\t2003\t1783\nSka/Reggae/Dancehall\t1977\t167\nRock & Roll\t1993\t32\nMetal\t2004\t19065\nHouse/Electronic/Trance\t1976\t1957\nPop\t1963\t5725\nLatin\t2009\t1754\nJazz\t1967\t3608\nPunk\t1984\t614\nSka/Reggae/Dancehall\t2011\t69\nSka/Reggae/Dancehall\t1985\t635\nFolk\t1969\t8508\nPop\t1996\t53391\nSka/Reggae/Dancehall\t1998\t1291\nRap/Hip-Hop\t1980\t55\nMetal\t1969\t1134\nMetal\t1978\t23\nTraditional Pop\t2008\t4\nRap/Hip-Hop\t2005\t66997\nCountry\t2006\t35872\nSka/Reggae/Dancehall\t1978\t76\nFolk\t1993\t1907\nBlues\t1962\t6623\nRock & Roll\t1963\t92757\nSoul\t1990\t7815\nTraditional Pop\t1996\t533\nRap/Hip-Hop\t2012\t51538\nJazz\t1970\t950\nMetal\t1990\t1424\nRock & Roll\t1962\t95755\nRock\t1986\t152825\nPop\t1989\t78064\nRock\t2014\t14674\nHouse/Electronic/Trance\t2005\t2267\nR&B\t1959\t1535\nRap/Hip-Hop\t1964\t16\nRap/Hip-Hop\t1984\t28\nR&B\t2010\t23645\nHouse/Electronic/Trance\t2015\t13260\nHouse/Electronic/Trance\t2014\t12742\nSoul\t1963\t57824\nTraditional Pop\t1973\t5254\nTraditional Pop\t1977\t7998\nPop\t1961\t3084\nRock & Roll\t1976\t10632\nSka/Reggae/Dancehall\t2010\t286\nR&B\t1966\t28\nSka/Reggae/Dancehall\t1982\t96\nRock\t1991\t80511\nR&B\t1965\t142\nMetal\t1992\t3704\nPop\t1997\t60038\nPop\t2005\t70443\nSoul\t1995\t2309\nHouse/Electronic/Trance\t1992\t16321\nCountry\t1958\t8329\nRock\t1966\t99600\nBlues\t1959\t19222\nCountry\t1975\t15779\nJazz\t1978\t3209\nSoul\t1973\t96488\nPunk\t2007\t15063\nLatin\t1998\t1554\nFolk\t2001\t2473\nFolk\t2010\t1637\nRock\t1988\t127638\nRock\t2004\t20687\nHouse/Electronic/Trance\t2002\t2229\nRock\t2007\t23350\nCountry\t1982\t21136\nCountry\t1987\t1149\nSka/Reggae/Dancehall\t1991\t4001\nSka/Reggae/Dancehall\t1959\t729\nSoul\t1977\t74399\nCountry\t1981\t28276\nLatin\t2010\t3934\nBlues\t1977\t41\nBlues\t1978\t142\nPop\t1995\t36762\nLatin\t2012\t718\nJazz\t1969\t2558\nRock & Roll\t1981\t5442\nR&B\t1987\t13948\nRap/Hip-Hop\t2001\t33068\nFolk\t2003\t2597\nPop\t1998\t50834\nTraditional Pop\t1974\t6191\nSoul\t1991\t8449\nHouse/Electronic/Trance\t1987\t3574\nFolk\t1991\t3087\nCountry\t1970\t14483\nPunk\t1990\t625\nSka/Reggae/Dancehall\t1970\t526\nR&B\t1962\t155\nR&B\t1985\t8701\nCountry\t1963\t12229\nFolk\t1958\t1144\nPop\t1960\t1791\nFolk\t1970\t20099\nCountry\t1967\t6370\nBlues\t2015\t1979\nTraditional Pop\t1995\t193\nMetal\t2002\t11158\nFolk\t1995\t10374\nFolk\t1968\t8103\nJazz\t1996\t227\nSoul\t2008\t904\nRock\t1970\t84492\nJazz\t1979\t4334\nPop\t2003\t43574\nRap/Hip-Hop\t2003\t59773\nRock & Roll\t1961\t87642\nTraditional Pop\t1978\t6026\nRap/Hip-Hop\t1987\t4396\nRock & Roll\t1994\t1879\nPop\t2013\t119342\nSoul\t1975\t82978\nBlues\t1964\t4261\nLatin\t1994\t4253\nRock\t1960\t3173\nPop\t1975\t17724\nFolk\t2007\t1879\nPop\t2000\t59385\nRock\t2010\t13202\nPunk\t2003\t4955\nPop\t1962\t1542\nSoul\t1964\t66348\nJazz\t1992\t526\nR&B\t1984\t3290\nJazz\t1999\t12\nPunk\t1972\t629\nFolk\t1977\t17621\nR&B\t2000\t62568\nR&B\t2013\t12509\nRock & Roll\t1959\t74070\nLatin\t1996\t1983\nTraditional Pop\t1961\t75093\nJazz\t1988\t3612\nJazz\t1991\t1384\nPop\t1964\t6702\nRock\t1978\t132593\nPop\t1978\t9017\nLatin\t2001\t3668\nRock & Roll\t1990\t1988\nTraditional Pop\t1959\t92613\nSoul\t1984\t53624\nR&B\t1995\t92003\nRap/Hip-Hop\t2010\t50047\nR&B\t2011\t16701\nCountry\t1959\t18447\nSka/Reggae/Dancehall\t1962\t185\nRap/Hip-Hop\t2000\t25931\nCountry\t2011\t53050\nR&B\t1983\t2143\nBlues\t1960\t10790\nFolk\t1984\t5847\nLatin\t1993\t4141\nSka/Reggae/Dancehall\t2000\t1142\nSoul\t1971\t79320\nRock\t2005\t20646\nRap/Hip-Hop\t1969\t217\nLatin\t1967\t322\nCountry\t1976\t9260\nLatin\t1974\t1114\nSoul\t1970\t84225\nHouse/Electronic/Trance\t1978\t4926\nCountry\t2002\t44194\nHouse/Electronic/Trance\t2008\t641\nPunk\t2010\t3304\nLatin\t2008\t159\nPunk\t1992\t11\nSoul\t1961\t44220\nFolk\t1985\t4836\nSka/Reggae/Dancehall\t2015\t1026\nCountry\t2014\t45044\nRock & Roll\t2014\t51\nCountry\t1996\t2143\nBlues\t1990\t203\nBlues\t1998\t138\nR&B\t1998\t86992\nHouse/Electronic/Trance\t1998\t3247\nMetal\t2016\t765\nBlues\t1967\t418\nRock\t1964\t63520\nJazz\t1971\t2401\nRock\t1976\t105978\nR&B\t1990\t38354\nR&B\t1989\t24796\nHouse/Electronic/Trance\t1966\t602\nPunk\t1981\t87\nMetal\t1998\t1212\nRock\t2006\t24704\nPunk\t2004\t4302\nFolk\t1976\t13269\nCountry\t1971\t15027\nCountry\t1994\t4996\nRock & Roll\t1966\t39664\nRock\t1961\t8528\nRock\t2016\t1819\nSoul\t1998\t3675\nSoul\t1969\t88635\nMetal\t1971\t4483\nFolk\t1982\t11984\nR&B\t2005\t43353\nR&B\t2009\t27178\nRock\t1997\t26567\nRap/Hip-Hop\t2008\t54521\nRap/Hip-Hop\t1992\t29495\nLatin\t1975\t9\nJazz\t1983\t3755\nRock\t2001\t32183\nFolk\t1973\t22516\nHouse/Electronic/Trance\t1985\t2533\nRock & Roll\t1991\t483\nRock & Roll\t1985\t738\nBlues\t2014\t1101\nCountry\t2015\t38552\nSka/Reggae/Dancehall\t2003\t6272\nSka/Reggae/Dancehall\t1979\t267\nMetal\t1996\t1381\nCountry\t2008\t33145\nPop\t1968\t18146\nJazz\t1985\t2957\nJazz\t1984\t286\nLatin\t1970\t35\nMetal\t1970\t1840\nRock\t1973\t84076\nJazz\t1980\t3730\nBlues\t1987\t930\nHouse/Electronic/Trance\t1979\t6129\nJazz\t1994\t1950\nHouse/Electronic/Trance\t1980\t446\nSoul\t1966\t60411\nCountry\t1984\t4851\nJazz\t1993\t2397\nJazz\t1982\t3308\nRap/Hip-Hop\t2013\t52305\nHouse/Electronic/Trance\t1986\t5558\nTraditional Pop\t1964\t31144\nSoul\t1981\t47022\nPunk\t2014\t2970\nBlues\t2000\t1854\nPunk\t2005\t13782\nRap/Hip-Hop\t2006\t56239\nFolk\t1979\t9167\nPunk\t2000\t1453\nLatin\t1966\t589\nFolk\t1971\t28983\nSoul\t1982\t41236\nRap/Hip-Hop\t2002\t49602\nCountry\t2007\t34349\nHouse/Electronic/Trance\t1993\t9903\nSka/Reggae/Dancehall\t1987\t27\nSka/Reggae/Dancehall\t1999\t357\nRock & Roll\t2015\t57\nRap/Hip-Hop\t1990\t21367\nSka/Reggae/Dancehall\t1994\t7958\nRock\t1958\t4807\nMetal\t1974\t179\nTraditional Pop\t2011\t21\nHouse/Electronic/Trance\t1960\t293\nPunk\t1958\t16\nSoul\t1979\t71266\nJazz\t1976\t2631\nTraditional Pop\t1994\t285\nSka/Reggae/Dancehall\t2014\t82\nBlues\t1980\t1139\nRock\t1979\t123999\nRock & Roll\t1983\t3474\nHouse/Electronic/Trance\t1958\t48\nPop\t2009\t106958\nLatin\t2011\t3142\nSoul\t1976\t84737\nFolk\t1964\t1999\nPop\t1979\t14051\nRock & Roll\t1975\t10845\nMetal\t2008\t9007\nRock\t2008\t21208\nTraditional Pop\t2016\t63\nRap/Hip-Hop\t2004\t80560\nPop\t1969\t16279\nSka/Reggae/Dancehall\t1995\t4821\nJazz\t1987\t4347\nR&B\t1963\t91\nFolk\t2000\t197\nRap/Hip-Hop\t1985\t956\nPunk\t1997\t10\nLatin\t1983\t1889\nFolk\t1963\t4056\nRock & Roll\t1977\t4933\nFolk\t1986\t3550\nCountry\t2010\t41090\nRock\t1965\t89408\nRock\t1972\t91294\nFolk\t1980\t16673\nTraditional Pop\t1986\t466\nMetal\t1979\t717\nHouse/Electronic/Trance\t1963\t3496\nFolk\t1981\t15342\nTraditional Pop\t1975\t8199\nTraditional Pop\t1983\t2020\nTraditional Pop\t2010\t2225\nCountry\t2004\t40918\nPop\t2008\t98175\nMetal\t1977\t41\nSka/Reggae/Dancehall\t1969\t869\nFolk\t1998\t11030\nPunk\t2009\t10216\nSka/Reggae/Dancehall\t1961\t72\nLatin\t2014\t3786\nFolk\t1972\t25908\nBlues\t1979\t1204\nR&B\t1979\t873\nSka/Reggae/Dancehall\t1983\t1019\nR&B\t1970\t949\nRock & Roll\t1995\t385\nTraditional Pop\t1963\t47299\nMetal\t2001\t11029\nSoul\t2006\t972\nCountry\t2012\t45912\nBlues\t1963\t5903\nFolk\t1961\t677\nTraditional Pop\t2013\t7\nHouse/Electronic/Trance\t1967\t1067\nJazz\t1964\t11773\nRap/Hip-Hop\t1989\t5570\nLatin\t2007\t950\nR&B\t1971\t4668\nRock & Roll\t1964\t64126\nCountry\t1988\t153\nHouse/Electronic/Trance\t1975\t1510\nPunk\t1963\t49\nRock & Roll\t1969\t20476\nFolk\t2014\t4701\nFolk\t2004\t874\nCountry\t1992\t3200\nMetal\t1997\t1617\nTraditional Pop\t1992\t80\nFolk\t2005\t153\nMetal\t1999\t6201\nSoul\t2004\t993\nSoul\t1967\t79239\nMetal\t2011\t1962\nPop\t1973\t18043\nHouse/Electronic/Trance\t2001\t4216\nRock & Roll\t1980\t4280\nTraditional Pop\t1972\t7787\nLatin\t2003\t1073\nRock\t1974\t73488\nPop\t2016\t75770\nBlues\t1975\t5672\nTraditional Pop\t1989\t4024\nLatin\t1969\t1131\nBlues\t1973\t2919\nTraditional Pop\t1997\t953\nLatin\t1965\t7\nMetal\t1967\t104\nRock\t2000\t38900\nCountry\t2009\t41118\nCountry\t1960\t24462\nLatin\t1968\t4302\nRap/Hip-Hop\t1997\t32695\nLatin\t2000\t10307\nRap/Hip-Hop\t2007\t56410\nLatin\t2016\t326\nPop\t2001\t51765\nTraditional Pop\t1967\t24659\nCountry\t1974\t20821\nSoul\t2000\t30\nR&B\t2004\t39044\nHouse/Electronic/Trance\t1984\t6372\nSka/Reggae/Dancehall\t1996\t1602\nSoul\t1968\t93035\nCountry\t1977\t14006\nHouse/Electronic/Trance\t1990\t8367\nHouse/Electronic/Trance\t2010\t3477\nSoul\t1992\t8474\nFolk\t2002\t2079\nMetal\t1980\t211\nPop\t1985\t19840\nFolk\t2016\t121\nRap/Hip-Hop\t1961\t173\nR&B\t1964\t305\nFolk\t1966\t9156\nR&B\t2003\t52799\nTraditional Pop\t1976\t4730\nCountry\t1999\t49612\nRap/Hip-Hop\t2014\t37920\nMetal\t2006\t7069\nPop\t1966\t7895\nSka/Reggae/Dancehall\t1992\t2945\nTraditional Pop\t2007\t579\nSka/Reggae/Dancehall\t2013\t37\nTraditional Pop\t1965\t34356\nRock\t1963\t15933\nPop\t1986\t34428\nPop\t1999\t48732\nRock\t1999\t47468\nSoul\t2002\t454\nSka/Reggae/Dancehall\t2009\t385\nJazz\t1990\t830\nPunk\t1967\t22\nPop\t2006\t74692\nRock & Roll\t1960\t94440\nSoul\t1962\t45231\nRock\t1959\t8838\nBlues\t1974\t4071\nPop\t1984\t24446\nHouse/Electronic/Trance\t2011\t6254\nHouse/Electronic/Trance\t1959\t45\nSoul\t1994\t8854\nCountry\t2003\t46792\nSka/Reggae/Dancehall\t1971\t703\nBlues\t1993\t22\nSoul\t1965\t62933\nHouse/Electronic/Trance\t1997\t5210\nRock & Roll\t1984\t680\nRock & Roll\t1974\t6782\nCountry\t1993\t4683\nPunk\t2015\t3245\nR&B\t1972\t654\nPunk\t1971\t155\nR&B\t2006\t33409\nRock\t1969\t82995\nFolk\t1974\t24798\nSoul\t1978\t70740\nHouse/Electronic/Trance\t1981\t4335\nPop\t1993\t37332\nJazz\t1960\t7220\nFolk\t1978\t16218\nPop\t1976\t18664\nHouse/Electronic/Trance\t1982\t3954\nPunk\t1989\t626\nMetal\t2015\t94\nSoul\t1960\t29982\nR&B\t1988\t19431\nSoul\t1993\t7379\nFolk\t1997\t21168\nR&B\t1986\t18454\nPunk\t1977\t261\nSka/Reggae/Dancehall\t1965\t156\n"}]},"apps":[],"jobName":"paragraph_1526458718691_948974022","id":"20180515-034345_750573462","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8844","user":"admin","dateFinished":"2018-05-16T09:14:54+0000","dateStarted":"2018-05-16T09:14:48+0000"},{"text":"%md\n\n### Bonus \n\nPretify the result by groupping the years to decades and percantage of scores.","dateUpdated":"2018-05-16T09:15:16+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Bonus</h3>\n<p>Pretify the result by groupping the years to decades and percantage of scores.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718692_947050278","id":"20180515-035941_261560170","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8845","user":"admin","dateFinished":"2018-05-16T09:02:20+0000","dateStarted":"2018-05-16T09:02:20+0000"},{"text":"%md\n\nThere is several way for calculating decade that corresponding the year.\n\nI would prefer doing this by using `substr` function to trim and `astype` function to convert data type.","dateUpdated":"2018-05-16T09:15:19+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>There is several way for calculating decade that corresponding the year.</p>\n<p>I would prefer doing this by using <code>substr</code> function to trim and <code>astype</code> function to convert data type.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718692_947050278","id":"20180515-040443_1646300554","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8846","user":"admin","dateFinished":"2018-05-16T09:02:21+0000","dateStarted":"2018-05-16T09:02:21+0000"},{"text":"%spark2.pyspark\n\nbillboardDF = billboardDF.withColumn('decade', (billboardDF.year.substr(1,3).astype(\"int\") * 10))\n\nz.show(billboardDF.limit(10))","dateUpdated":"2018-05-16T09:15:22+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\tartist\ttitle\tcountry\tdate\tgenre\trank\ttrack_id\tartist_song\tscore\tyear\tdecade\n132\tThe Marvelettes\tToo Many Fish In The Sea\tUnited States\t1964-11-14 00:00:00.0\tSoul\t74\t0PgZO2KF47yBddD48hj9Rd\tThe Marvelettes - Too Many Fish In The Sea\t27\t1964\t1960\n265\tBobby Vinton\tJust As Much As Ever\tUnited States\t1968-01-13 00:00:00.0\tTraditional Pop\t52\t3RfkdH5PGEn0pJpbV4H8qp\tBobby Vinton - Just As Much As Ever\t49\t1968\t1960\n393\tLittle Willie John\tTake My Love (I Want To Give It All To You)\tUnited States\t1961-09-23 00:00:00.0\tSoul\t87\t0Xxoa4TSPt1zSAURgzKJN1\tLittle Willie John - Take My Love (I Want To Give It All To You)\t14\t1961\t1960\n1221\tThe Ames Brothers\tChina Doll\tUnited States\t1960-03-19 00:00:00.0\tTraditional Pop\t69\tnull\tThe Ames Brothers - China Doll\t32\t1960\t1960\n1373\tEvery Mothers' Son\tNo One Knows\tUnited States\t1968-01-27 00:00:00.0\tPop\t99\tnull\tEvery Mothers' Son - No One Knows\t2\t1968\t1960\n1783\tThe Dovells\tBristol Stomp\tUnited States\t1961-10-14 00:00:00.0\tTraditional Pop\t5\t0B1cm1Z7J9v8Wug9idr8T6\tThe Dovells - Bristol Stomp\t96\t1961\t1960\n2410\tBuster Brown\tFannie Mae\tUnited States\t1960-03-26 00:00:00.0\tBlues\t54\t1ySkB2a4SFjhWwIpkdJBzw\tBuster Brown - Fannie Mae\t47\t1960\t1960\n2691\tMarvin Gaye\tYou\tUnited States\t1968-01-27 00:00:00.0\tSoul\t45\t0XVL0KnJsZ52cCGimf2t7J\tMarvin Gaye - You\t56\t1968\t1960\n2719\tJim & Jean\tPeople World\tUnited States\t1968-03-02 00:00:00.0\tFolk\t95\t16ZfZjJ4lhighF4tJHQbQy\tJim & Jean - People World\t6\t1968\t1960\n3372\tBobby Hebb\tSunny\tUnited States\t1966-09-07 00:00:00.0\tSoul\t64\t1GVafg6PWpBt5rWTMruzwG\tBobby Hebb - Sunny\t37\t1966\t1960\n"}]},"apps":[],"jobName":"paragraph_1526458718693_946665529","id":"20180515-040141_109433443","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8847","user":"admin","dateFinished":"2018-05-16T09:15:24+0000","dateStarted":"2018-05-16T09:15:23+0000"},{"text":"%md\n\nFor calculating percents of score, we will need total sum of scores.","dateUpdated":"2018-05-16T09:15:38+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>For calculating percents of score, we will need total sum of scores.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718693_946665529","id":"20180515-044537_1281129804","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8848","user":"admin","dateFinished":"2018-05-16T09:02:22+0000","dateStarted":"2018-05-16T09:02:22+0000"},{"text":"%spark2.pyspark\n\ntotalScoresDF = billboardDF\\\n                .groupBy('decade')\\\n                .agg(sum('score').alias('yearTotalScore'))\n                \nz.show(totalScoresDF)","dateUpdated":"2018-05-16T09:15:46+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"decade\tyearTotalScore\n1990\t2591681\n1950\t356087\n1960\t2587707\n1970\t2577636\n1980\t2601250\n2000\t2629643\n2010\t1739734\n"}]},"apps":[],"jobName":"paragraph_1526458718693_946665529","id":"20180515-044921_1963192190","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8849","user":"admin","dateFinished":"2018-05-16T09:15:49+0000","dateStarted":"2018-05-16T09:15:46+0000"},{"text":"%md\n\nNow, let's assign grouped genre data to another dataframe. ","dateUpdated":"2018-05-16T09:16:00+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Now, let's assign grouped genre data to another dataframe.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718694_947819776","id":"20180515-044908_1932321704","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8850","user":"admin","dateFinished":"2018-05-16T09:02:23+0000","dateStarted":"2018-05-16T09:02:23+0000"},{"text":"%spark2.pyspark\n\ngenreDF = billboardDF.groupBy(['genre','decade']) \\\n                       .agg(sum('score').alias('score')) \\\n                       .select(\"*\")\n                       \nz.show(genreDF)","dateUpdated":"2018-05-16T09:16:02+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"genre\tdecade\tscore\nPop\t2000\t685703\nRock & Roll\t1970\t69175\nBlues\t1960\t48467\nRock\t1950\t13645\nSoul\t1990\t52207\nJazz\t1990\t7910\nTraditional Pop\t1960\t424649\nRap/Hip-Hop\t1980\t20674\nPop\t1980\t329592\nR&B\t2000\t461458\nTraditional Pop\t1990\t5535\nRock & Roll\t2010\t242\nR&B\t1950\t1535\nPunk\t1990\t2137\nCountry\t1980\t94056\nSka/Reggae/Dancehall\t1980\t5582\nPunk\t1950\t16\nPunk\t1960\t1836\nHouse/Electronic/Trance\t1970\t18069\nJazz\t1960\t66508\nCountry\t2010\t294542\nSka/Reggae/Dancehall\t1960\t3982\nBlues\t1950\t22625\nR&B\t1970\t7454\nLatin\t1980\t15777\nSoul\t2000\t10578\nLatin\t1960\t7807\nTraditional Pop\t2010\t2372\nRap/Hip-Hop\t1950\t301\nSoul\t1950\t31051\nRap/Hip-Hop\t1990\t347611\nMetal\t2000\t112599\nMetal\t1980\t3007\nRock & Roll\t1950\t104252\nRock & Roll\t1990\t4779\nPunk\t2010\t18097\nR&B\t1960\t1648\nHouse/Electronic/Trance\t2000\t15035\nRock & Roll\t1980\t22435\nSoul\t2010\t1061\nSka/Reggae/Dancehall\t2010\t1695\nR&B\t1980\t91514\nRock & Roll\t1960\t571961\nSka/Reggae/Dancehall\t1970\t1963\nMetal\t2010\t5312\nLatin\t2010\t12717\nHouse/Electronic/Trance\t1990\t82446\nJazz\t2000\t269\nLatin\t2000\t29452\nRock\t1980\t1440349\nPop\t1960\t84631\nPunk\t1980\t5513\nMetal\t1960\t1238\nBlues\t2000\t1854\nFolk\t1950\t4147\nBlues\t1990\t394\nPunk\t1970\t2468\nSoul\t1960\t627858\nSoul\t1970\t824032\nJazz\t1950\t10128\nBlues\t1970\t25044\nR&B\t1990\t714281\nR&B\t2010\t103068\nJazz\t1970\t20724\nRock & Roll\t2000\t8\nTraditional Pop\t1980\t31937\nCountry\t1960\t124090\nRap/Hip-Hop\t2000\t529892\nRap/Hip-Hop\t2010\t342620\nFolk\t1980\t80590\nBlues\t1980\t8289\nMetal\t1970\t13436\nFolk\t1970\t201159\nLatin\t1970\t1158\nFolk\t2000\t16964\nRock\t2000\t249294\nHouse/Electronic/Trance\t1950\t93\nRap/Hip-Hop\t1960\t406\nPop\t1990\t508208\nHouse/Electronic/Trance\t2010\t63747\nBlues\t2010\t3080\nTraditional Pop\t2000\t1157\nSka/Reggae/Dancehall\t1950\t913\nLatin\t1990\t32599\nFolk\t1990\t92723\nCountry\t1970\t140521\nPop\t1970\t206258\nMetal\t1990\t22174\nSoul\t1980\t382323\nFolk\t1960\t55891\nTraditional Pop\t1950\t136243\nCountry\t2000\t411260\nPunk\t2000\t74866\nJazz\t1980\t29717\nPop\t2010\t817890\nSka/Reggae/Dancehall\t1990\t37758\nFolk\t2010\t23422\nRock\t1960\t557683\nRock\t2010\t49869\nTraditional Pop\t1970\t72077\nCountry\t1990\t100933\nRock\t1990\t579986\nCountry\t1950\t26776\nRock\t1970\t974098\nPop\t1950\t4362\nHouse/Electronic/Trance\t1980\t39895\nHouse/Electronic/Trance\t1960\t9052\nSka/Reggae/Dancehall\t2000\t29254\n"}]},"apps":[],"jobName":"paragraph_1526458718694_947819776","id":"20180515-044509_1699822423","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8851","user":"admin","dateFinished":"2018-05-16T09:16:06+0000","dateStarted":"2018-05-16T09:16:02+0000"},{"text":"%md\n\nNow, we have 2 different grouped dataframe. For making more readable code we can give aliases to data frames.\n\nLet's join them with `join` method of spark.","dateUpdated":"2018-05-16T09:16:15+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Now, we have 2 different grouped dataframe. For making more readable code we can give aliases to data frames.</p>\n<p>Let's join them with <code>join</code> method of spark.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718694_947819776","id":"20180516-051808_844493715","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8852","user":"admin","dateFinished":"2018-05-16T09:02:23+0000","dateStarted":"2018-05-16T09:02:23+0000"},{"text":"%spark2.pyspark\n\nt1 = genreDF.alias('t1')\nt2 = totalScoresDF.alias('t2')\n\ngroupedDF = t1.join(t2, t1['decade'] == t2['decade'], 'left')\\\n            .select('t1.*','t2.yearTotalScore')\n        \nz.show(groupedDF.limit(10))","dateUpdated":"2018-05-16T09:17:29+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"genre\tdecade\tscore\tyearTotalScore\nPop\t2000\t685703\t2629643\nRock & Roll\t1970\t69175\t2577636\nBlues\t1960\t48467\t2587707\nRock\t1950\t13645\t356087\nSoul\t1990\t52207\t2591681\nJazz\t1990\t7910\t2591681\nTraditional Pop\t1960\t424649\t2587707\nRap/Hip-Hop\t1980\t20674\t2601250\nPop\t1980\t329592\t2601250\nR&B\t2000\t461458\t2629643\n"}]},"apps":[],"jobName":"paragraph_1526458718695_947435027","id":"20180516-052004_1288873630","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8853","user":"admin","dateFinished":"2018-05-16T09:17:33+0000","dateStarted":"2018-05-16T09:17:29+0000"},{"text":"%md\n\nAnd I will use `format_number` for rounding percentages.\n\nFor better looking labels we can make some little changes in \"**decade**\" column.","dateUpdated":"2018-05-16T09:16:51+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>And I will use <code>format_number</code> for rounding percentages.</p>\n<p>For better looking labels we can make some little changes in &ldquo;<strong>decade</strong>&rdquo; column.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718697_945126533","id":"20180515-045303_1697604001","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8854","user":"admin","dateFinished":"2018-05-16T09:02:24+0000","dateStarted":"2018-05-16T09:02:24+0000"},{"text":"%spark2.pyspark\n\nz.show(\n    groupedDF.select(\n        groupedDF['genre'],\n        concat(groupedDF['decade'].astype(\"string\").substr(3,1),lit('0s')).alias('decades'),\n        format_number((groupedDF['score'] / groupedDF['yearTotalScore']) * 100, 1).alias('scorePercent')\n    )\n    .sort('decade')\n)","dateUpdated":"2018-05-16T09:17:12+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false,"setting":{"lineChart":{}},"commonSetting":{},"keys":[{"name":"decades","index":1,"aggr":"sum"}],"groups":[{"name":"genre","index":0,"aggr":"sum"}],"values":[{"name":"scorePercent","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"genre\tdecades\tscorePercent\nFolk\t50s\t1.2\nJazz\t50s\t2.8\nRap/Hip-Hop\t50s\t0.1\nSoul\t50s\t8.7\nRock\t50s\t3.8\nPunk\t50s\t0.0\nRock & Roll\t50s\t29.3\nHouse/Electronic/Trance\t50s\t0.0\nSka/Reggae/Dancehall\t50s\t0.3\nTraditional Pop\t50s\t38.3\nBlues\t50s\t6.4\nCountry\t50s\t7.5\nR&B\t50s\t0.4\nPop\t50s\t1.2\nLatin\t60s\t0.3\nTraditional Pop\t60s\t16.4\nSoul\t60s\t24.3\nCountry\t60s\t4.8\nPunk\t60s\t0.1\nR&B\t60s\t0.1\nRap/Hip-Hop\t60s\t0.0\nSka/Reggae/Dancehall\t60s\t0.2\nRock & Roll\t60s\t22.1\nJazz\t60s\t2.6\nFolk\t60s\t2.2\nRock\t60s\t21.6\nBlues\t60s\t1.9\nPop\t60s\t3.3\nMetal\t60s\t0.0\nHouse/Electronic/Trance\t60s\t0.3\nPunk\t70s\t0.1\nSoul\t70s\t32.0\nJazz\t70s\t0.8\nMetal\t70s\t0.5\nCountry\t70s\t5.5\nRock\t70s\t37.8\nBlues\t70s\t1.0\nLatin\t70s\t0.0\nFolk\t70s\t7.8\nHouse/Electronic/Trance\t70s\t0.7\nRock & Roll\t70s\t2.7\nPop\t70s\t8.0\nSka/Reggae/Dancehall\t70s\t0.1\nR&B\t70s\t0.3\nTraditional Pop\t70s\t2.8\nMetal\t80s\t0.1\nFolk\t80s\t3.1\nPop\t80s\t12.7\nPunk\t80s\t0.2\nCountry\t80s\t3.6\nSka/Reggae/Dancehall\t80s\t0.2\nTraditional Pop\t80s\t1.2\nRap/Hip-Hop\t80s\t0.8\nBlues\t80s\t0.3\nRock & Roll\t80s\t0.9\nR&B\t80s\t3.5\nSoul\t80s\t14.7\nJazz\t80s\t1.1\nLatin\t80s\t0.6\nRock\t80s\t55.4\nHouse/Electronic/Trance\t80s\t1.5\nBlues\t90s\t0.0\nPunk\t90s\t0.1\nRock & Roll\t90s\t0.2\nLatin\t90s\t1.3\nRap/Hip-Hop\t90s\t13.4\nR&B\t90s\t27.6\nSoul\t90s\t2.0\nFolk\t90s\t3.6\nMetal\t90s\t0.9\nTraditional Pop\t90s\t0.2\nHouse/Electronic/Trance\t90s\t3.2\nSka/Reggae/Dancehall\t90s\t1.5\nRock\t90s\t22.4\nCountry\t90s\t3.9\nJazz\t90s\t0.3\nPop\t90s\t19.6\nSoul\t00s\t0.4\nRock & Roll\t00s\t0.0\nFolk\t00s\t0.6\nPop\t00s\t26.1\nCountry\t00s\t15.6\nLatin\t00s\t1.1\nR&B\t00s\t17.5\nSka/Reggae/Dancehall\t00s\t1.1\nBlues\t00s\t0.1\nRap/Hip-Hop\t00s\t20.2\nRock\t00s\t9.5\nMetal\t00s\t4.3\nTraditional Pop\t00s\t0.0\nPunk\t00s\t2.8\nHouse/Electronic/Trance\t00s\t0.6\nJazz\t00s\t0.0\nRock & Roll\t10s\t0.0\nCountry\t10s\t16.9\nTraditional Pop\t10s\t0.1\nPunk\t10s\t1.0\nSka/Reggae/Dancehall\t10s\t0.1\nFolk\t10s\t1.3\nR&B\t10s\t5.9\nRap/Hip-Hop\t10s\t19.7\nSoul\t10s\t0.1\nBlues\t10s\t0.2\nMetal\t10s\t0.3\nRock\t10s\t2.9\nHouse/Electronic/Trance\t10s\t3.7\nLatin\t10s\t0.7\nPop\t10s\t47.0\n"}]},"apps":[],"jobName":"paragraph_1526458718698_946280780","id":"20180515-043911_605485945","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8855","user":"admin","dateFinished":"2018-05-16T09:17:18+0000","dateStarted":"2018-05-16T09:17:13+0000"},{"text":"%md\n\n### Question 4\n\nFind the Top 10 artists according to the dataset","dateUpdated":"2018-05-16T09:17:50+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Question 4</h3>\n<p>Find the Top 10 artists according to the dataset</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718698_946280780","id":"20180515-053150_205624909","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8856","user":"admin","dateFinished":"2018-05-16T09:02:25+0000","dateStarted":"2018-05-16T09:02:25+0000"},{"text":"%md \n\nLet's grouped our data by artist and count the scores for finding out the artists that most appearances on the list.","dateUpdated":"2018-05-16T09:17:55+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Let's grouped our data by artist and count the scores for finding out the artists that most appearances on the list.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718698_946280780","id":"20180507-133615_883896409","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8857","user":"admin","dateFinished":"2018-05-16T09:02:26+0000","dateStarted":"2018-05-16T09:02:26+0000"},{"text":"%spark2.pyspark\n\nz.show(\n    billboardDF\n    .groupBy('artist')\n    .agg(count('score').alias('appearances'))\n    .sort('appearances', ascending=False)\n    .limit(10)\n)","dateUpdated":"2018-05-16T09:18:41+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"artist\tappearances\nElvis Presley\t985\nElton John\t954\nMadonna\t885\nTaylor Swift\t853\nRihanna\t816\nKenny Chesney\t805\nTim McGraw\t793\nDrake\t793\nUsher\t729\nJay-Z\t729\n"}]},"apps":[],"jobName":"paragraph_1526458718699_945896031","id":"20180516-050202_610633900","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8858","user":"admin","dateFinished":"2018-05-16T09:18:47+0000","dateStarted":"2018-05-16T09:18:41+0000"},{"text":"%md\n\nWell, if you wonder which artists has more leading in rank 1, we can find out just adding one filter.","dateUpdated":"2018-05-16T09:18:13+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Well, if you wonder which artists has more leading in rank 1, we can find out just adding one filter.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718699_945896031","id":"20180516-083959_695117389","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8859","user":"admin","dateFinished":"2018-05-16T09:02:27+0000","dateStarted":"2018-05-16T09:02:27+0000"},{"text":"%spark2.pyspark\n\nz.show(\n    billboardDF\n    .filter(billboardDF['rank'] == 1)\n    .groupBy('artist')\n    .agg(count('title').alias('rank_1_count'))\n    .sort('rank_1_count', ascending=False)\n    .limit(10)\n)","dateUpdated":"2018-05-16T09:18:27+0000","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"artist\trank_1_count\nMariah Carey\t79\nThe Beatles\t59\nUsher\t47\nBeyonce\t36\nRihanna\t34\nBoyz II Men\t34\nJanet Jackson\t33\nKaty Perry\t33\nMadonna\t32\nMichael Jackson\t31\n"}]},"apps":[],"jobName":"paragraph_1526458718699_945896031","id":"20180516-060425_1239111495","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8860","user":"admin","dateFinished":"2018-05-16T09:18:30+0000","dateStarted":"2018-05-16T09:18:28+0000"},{"text":"%md\n\n### Question 5\n\nHow has the song diversity changed over time?","dateUpdated":"2018-05-16T09:18:57+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Question 5</h3>\n<p>How has the song diversity changed over time?</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718699_945896031","id":"20180516-085055_1352200636","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8861","user":"admin","dateFinished":"2018-05-16T09:02:29+0000","dateStarted":"2018-05-16T09:02:29+0000"},{"text":"%md\n\nBefore ending this workshop let's spice it up a little bit and find out the answer with pure `SQL` :)","dateUpdated":"2018-05-16T09:19:00+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Before ending this workshop let's spice it up a little bit and find out the answer with pure <code>SQL</code> :)</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718700_943972287","id":"20180516-084607_1631025490","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8862","user":"admin","dateFinished":"2018-05-16T09:02:29+0000","dateStarted":"2018-05-16T09:02:29+0000"},{"text":"%md\n\nFor running \"**SQL**\", we have to register our data frame as a table with `registerTempTable` function of spark.","dateUpdated":"2018-05-16T09:19:05+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>For running &ldquo;<strong>SQL</strong>&ldquo;, we have to register our data frame as a table with <code>registerTempTable</code> function of spark.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718700_943972287","id":"20180516-085314_1517424436","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8863","user":"admin","dateFinished":"2018-05-16T09:02:29+0000","dateStarted":"2018-05-16T09:02:29+0000"},{"text":"%spark2.pyspark\n\nbillboardDF.registerTempTable(\"billboard\")","dateUpdated":"2018-05-16T09:19:16+0000","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1526458718700_943972287","id":"20180516-085650_1989861970","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8864","user":"admin","dateFinished":"2018-05-16T09:19:17+0000","dateStarted":"2018-05-16T09:19:17+0000"},{"text":"%md\n\nPlease note that, for running \"**SQL**\" change your Zeppelin interpreter to `%spark2.sql` like in the below.","dateUpdated":"2018-05-16T09:19:24+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Please note that, for running &ldquo;<strong>SQL</strong>&rdquo; change your Zeppelin interpreter to <code>%spark2.sql</code> like in the below.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718701_943587538","id":"20180516-090024_60716832","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8865","user":"admin","dateFinished":"2018-05-16T09:02:30+0000","dateStarted":"2018-05-16T09:02:30+0000"},{"text":"%spark2.sql\n\nSELECT * FROM billboard LIMIT 10","dateUpdated":"2018-05-16T09:19:28+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\tartist\ttitle\tcountry\tdate\tgenre\trank\ttrack_id\tartist_song\tscore\tyear\tdecade\n132\tThe Marvelettes\tToo Many Fish In The Sea\tUnited States\t1964-11-14 00:00:00.0\tSoul\t74\t0PgZO2KF47yBddD48hj9Rd\tThe Marvelettes - Too Many Fish In The Sea\t27\t1964\t1960\n265\tBobby Vinton\tJust As Much As Ever\tUnited States\t1968-01-13 00:00:00.0\tTraditional Pop\t52\t3RfkdH5PGEn0pJpbV4H8qp\tBobby Vinton - Just As Much As Ever\t49\t1968\t1960\n393\tLittle Willie John\tTake My Love (I Want To Give It All To You)\tUnited States\t1961-09-23 00:00:00.0\tSoul\t87\t0Xxoa4TSPt1zSAURgzKJN1\tLittle Willie John - Take My Love (I Want To Give It All To You)\t14\t1961\t1960\n1221\tThe Ames Brothers\tChina Doll\tUnited States\t1960-03-19 00:00:00.0\tTraditional Pop\t69\tnull\tThe Ames Brothers - China Doll\t32\t1960\t1960\n1373\tEvery Mothers' Son\tNo One Knows\tUnited States\t1968-01-27 00:00:00.0\tPop\t99\tnull\tEvery Mothers' Son - No One Knows\t2\t1968\t1960\n1783\tThe Dovells\tBristol Stomp\tUnited States\t1961-10-14 00:00:00.0\tTraditional Pop\t5\t0B1cm1Z7J9v8Wug9idr8T6\tThe Dovells - Bristol Stomp\t96\t1961\t1960\n2410\tBuster Brown\tFannie Mae\tUnited States\t1960-03-26 00:00:00.0\tBlues\t54\t1ySkB2a4SFjhWwIpkdJBzw\tBuster Brown - Fannie Mae\t47\t1960\t1960\n2691\tMarvin Gaye\tYou\tUnited States\t1968-01-27 00:00:00.0\tSoul\t45\t0XVL0KnJsZ52cCGimf2t7J\tMarvin Gaye - You\t56\t1968\t1960\n2719\tJim & Jean\tPeople World\tUnited States\t1968-03-02 00:00:00.0\tFolk\t95\t16ZfZjJ4lhighF4tJHQbQy\tJim & Jean - People World\t6\t1968\t1960\n3372\tBobby Hebb\tSunny\tUnited States\t1966-09-07 00:00:00.0\tSoul\t64\t1GVafg6PWpBt5rWTMruzwG\tBobby Hebb - Sunny\t37\t1966\t1960\n"}]},"apps":[],"jobName":"paragraph_1526458718701_943587538","id":"20180516-085810_1803993547","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8866","user":"admin","dateFinished":"2018-05-16T09:19:29+0000","dateStarted":"2018-05-16T09:19:28+0000"},{"text":"%md\nBack to the question","user":"admin","dateUpdated":"2018-05-16T09:20:31+0000","config":{"colWidth":12,"enabled":false,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526462384697_-512065336","id":"20180516-091944_1435273983","dateCreated":"2018-05-16T09:19:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:23010","dateFinished":"2018-05-16T09:20:24+0000","dateStarted":"2018-05-16T09:20:24+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Back to the question</p>\n"}]}},{"text":"%spark2.sql\n\nSELECT \n    SUM(songCount), year\nFROM(\n    SELECT \n        COUNT(DISTINCT artist_song) songCount, year\n    FROM \n        billboard \n    GROUP BY \n        artist_song, year\n)\nGROUP BY\n    year\nORDER BY \n    year ASC","dateUpdated":"2018-05-16T09:20:04+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false,"setting":{"lineChart":{}},"commonSetting":{},"keys":[{"name":"year","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"sum(songCount)","index":0,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"sum(songCount)\tyear\n322\t1958\n618\t1959\n661\t1960\n749\t1961\n731\t1962\n724\t1963\n791\t1964\n785\t1965\n805\t1966\n803\t1967\n749\t1968\n737\t1969\n697\t1970\n679\t1971\n655\t1972\n586\t1973\n567\t1974\n615\t1975\n583\t1976\n538\t1977\n514\t1978\n551\t1979\n525\t1980\n490\t1981\n515\t1982\n532\t1983\n506\t1984\n485\t1985\n491\t1986\n488\t1987\n482\t1988\n485\t1989\n463\t1990\n466\t1991\n430\t1992\n434\t1993\n421\t1994\n422\t1995\n393\t1996\n427\t1997\n462\t1998\n417\t1999\n418\t2000\n388\t2001\n402\t2002\n406\t2003\n398\t2004\n442\t2005\n472\t2006\n463\t2007\n505\t2008\n548\t2009\n587\t2010\n604\t2011\n482\t2012\n498\t2013\n461\t2014\n514\t2015\n366\t2016\n"}]},"apps":[],"jobName":"paragraph_1526458718701_943587538","id":"20180516-090304_1500205026","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8867","user":"admin","dateFinished":"2018-05-16T09:20:12+0000","dateStarted":"2018-05-16T09:20:04+0000"},{"text":"%md\n\n### Final","dateUpdated":"2018-05-16T09:20:48+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Final</h3>\n"}]},"apps":[],"jobName":"paragraph_1526458718701_943587538","id":"20180516-044146_1735316934","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8868","user":"admin","dateFinished":"2018-05-16T09:02:32+0000","dateStarted":"2018-05-16T09:02:32+0000"},{"text":"%md\n\nIn this section, we will prepare a dataset for next \"**Machine Learning** Workshop\" ","user":"admin","dateUpdated":"2018-05-16T09:23:57+0000","config":{"colWidth":12,"enabled":false,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526462502806_1664783168","id":"20180516-092142_1025109562","dateCreated":"2018-05-16T09:21:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:23402","dateFinished":"2018-05-16T09:23:52+0000","dateStarted":"2018-05-16T09:23:52+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>In this section, we will prepare a dataset for next &ldquo;<strong>Machine Learning</strong> Workshop&rdquo;</p>\n"}]}},{"text":"%spark2.pyspark\n\ntracksDF = spark.read.csv(\"/user/userX/zpl/trackFeatures.csv\", header=True, inferSchema=True)","dateUpdated":"2018-05-16T09:21:17+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1526458718702_944741784","id":"20180516-041148_1565478731","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8869","user":"admin","dateFinished":"2018-05-16T09:21:11+0000","dateStarted":"2018-05-16T09:21:10+0000"},{"text":"%spark2.pyspark\n\nz.show(tracksDF.limit(10))","dateUpdated":"2018-05-16T09:21:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\tacousticness\tdanceability\tenergy\tinstrumentalness\tkey\tliveness\tloudness\tmode\tspeechiness\ttempo\tvalence\ttime_signature\n1d4zMkLqBRC12BSWZNfa5G\t0.134\t0.782\t0.67\t0.0\t2\t0.0843\t-11.849\t1\t0.0501\t135.075\t0.961\t4\n2bW2ddWrNR7sHh6Vtqq3Fb\t0.7070000000000001\t0.682\t0.534\t0.0\t5\t0.11599999999999999\t-11.477\t0\t0.0476\t116.736\t0.872\t4\n1LH5cfUbeIqchZ4XXqygKf\t0.659\t0.581\t0.7440000000000001\t0.0\t5\t0.11\t-6.721\t1\t0.0407\t137.187\t0.909\t4\n0aEbLXJflABe8msSmZNVZj\t0.7120000000000001\t0.7170000000000001\t0.48\t0.0\t7\t0.371\t-14.2\t1\t0.037000000000000005\t116.595\t0.883\t4\n6OPdWdyWMq7gk5a5byZiSf\t0.183\t0.6920000000000001\t0.7609999999999999\t0.0\t5\t0.11900000000000001\t-7.402\t1\t0.0344\t133.196\t0.961\t4\n5onwsM1DmyaCTZoSwU2mHB\t0.7390000000000001\t0.247\t0.449\t1.52E-4\t5\t0.35700000000000004\t-7.749\t1\t0.03\t101.445\t0.39\t3\n3evKKHWfJEODXUcntWlejD\t0.527\t0.335\t0.311\t2.88E-6\t0\t0.0913\t-11.467\t1\t0.0351\t140.156\t0.61\t4\n05oMNN5Rbv6rVqyFFG9uTl\t0.9470000000000001\t0.5820000000000001\t0.302\t0.0107\t9\t0.0931\t-11.624\t1\t0.0353\t94.288\t0.642\t4\n1ySkB2a4SFjhWwIpkdJBzw\t0.759\t0.664\t0.449\t0.00277\t5\t0.24100000000000002\t-10.184\t1\t0.0283\t119.93\t0.828\t4\n2X23093vTzc9U5dr721Pqm\t0.594\t0.7340000000000001\t0.586\t4.4400000000000006E-4\t0\t0.0852\t-8.613\t1\t0.0566\t138.735\t0.961\t4\n"}]},"apps":[],"jobName":"paragraph_1526458718702_944741784","id":"20180516-041344_1940115615","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8870","user":"admin","dateFinished":"2018-05-16T09:21:19+0000","dateStarted":"2018-05-16T09:21:19+0000"},{"text":"%spark2.pyspark\n\nmergedDF = \\\n            billboardDF\\\n            .join(tracksDF, billboardDF['track_id'] == tracksDF['id'], 'inner')\n        \nz.show(mergedDF.limit(10))","dateUpdated":"2018-05-16T09:24:36+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\tartist\ttitle\tcountry\tdate\tgenre\trank\ttrack_id\tartist_song\tscore\tyear\tdecade\tid\tacousticness\tdanceability\tenergy\tinstrumentalness\tkey\tliveness\tloudness\tmode\tspeechiness\ttempo\tvalence\ttime_signature\n132\tThe Marvelettes\tToo Many Fish In The Sea\tUnited States\t1964-11-14 00:00:00.0\tSoul\t74\t0PgZO2KF47yBddD48hj9Rd\tThe Marvelettes - Too Many Fish In The Sea\t27\t1964\t1960\t0PgZO2KF47yBddD48hj9Rd\t0.135\t0.79\t0.5479999999999999\t1.4599999999999999E-5\t0\t0.308\t-13.610999999999999\t1\t0.0406\t91.947\t0.9640000000000001\t4\n265\tBobby Vinton\tJust As Much As Ever\tUnited States\t1968-01-13 00:00:00.0\tTraditional Pop\t52\t3RfkdH5PGEn0pJpbV4H8qp\tBobby Vinton - Just As Much As Ever\t49\t1968\t1960\t3RfkdH5PGEn0pJpbV4H8qp\t0.883\t0.442\t0.11199999999999999\t0.0\t1\t0.138\t-15.924000000000001\t1\t0.0298\t85.01\t0.33299999999999996\t4\n393\tLittle Willie John\tTake My Love (I Want To Give It All To You)\tUnited States\t1961-09-23 00:00:00.0\tSoul\t87\t0Xxoa4TSPt1zSAURgzKJN1\tLittle Willie John - Take My Love (I Want To Give It All To You)\t14\t1961\t1960\t0Xxoa4TSPt1zSAURgzKJN1\t0.691\t0.475\t0.456\t0.0\t1\t0.0662\t-13.244000000000002\t1\t0.0423\t66.118\t0.77\t4\n1783\tThe Dovells\tBristol Stomp\tUnited States\t1961-10-14 00:00:00.0\tTraditional Pop\t5\t0B1cm1Z7J9v8Wug9idr8T6\tThe Dovells - Bristol Stomp\t96\t1961\t1960\t0B1cm1Z7J9v8Wug9idr8T6\t0.56\t0.665\t0.7879999999999999\t0.0\t2\t0.524\t-6.146\t1\t0.0639\t105.62\t0.907\t4\n2410\tBuster Brown\tFannie Mae\tUnited States\t1960-03-26 00:00:00.0\tBlues\t54\t1ySkB2a4SFjhWwIpkdJBzw\tBuster Brown - Fannie Mae\t47\t1960\t1960\t1ySkB2a4SFjhWwIpkdJBzw\t0.759\t0.664\t0.449\t0.00277\t5\t0.24100000000000002\t-10.184\t1\t0.0283\t119.93\t0.828\t4\n2691\tMarvin Gaye\tYou\tUnited States\t1968-01-27 00:00:00.0\tSoul\t45\t0XVL0KnJsZ52cCGimf2t7J\tMarvin Gaye - You\t56\t1968\t1960\t0XVL0KnJsZ52cCGimf2t7J\t0.264\t0.644\t0.597\t0.0\t0\t0.254\t-6.455\t1\t0.0332\t110.40799999999999\t0.9009999999999999\t4\n2719\tJim & Jean\tPeople World\tUnited States\t1968-03-02 00:00:00.0\tFolk\t95\t16ZfZjJ4lhighF4tJHQbQy\tJim & Jean - People World\t6\t1968\t1960\t16ZfZjJ4lhighF4tJHQbQy\t0.13\t0.49\t0.488\t0.0\t4\t0.142\t-12.793\t1\t0.0355\t138.026\t0.59\t4\n3372\tBobby Hebb\tSunny\tUnited States\t1966-09-07 00:00:00.0\tSoul\t64\t1GVafg6PWpBt5rWTMruzwG\tBobby Hebb - Sunny\t37\t1966\t1960\t1GVafg6PWpBt5rWTMruzwG\t0.851\t0.7190000000000001\t0.33799999999999997\t3.33E-6\t4\t0.348\t-11.175\t0\t0.0418\t128.346\t0.7509999999999999\t4\n3618\tBaby Washington\tThat's How Heartaches Are Made\tUnited States\t1963-05-18 00:00:00.0\tSoul\t46\t5LJjg4XXwyHVuohOKsI60g\tBaby Washington - That's How Heartaches Are Made\t55\t1963\t1960\t5LJjg4XXwyHVuohOKsI60g\t0.47100000000000003\t0.58\t0.40399999999999997\t0.0\t9\t0.265\t-10.099\t1\t0.0285\t98.91799999999999\t0.467\t4\n3642\tThe Shacklefords\tA Stranger In Your Town\tUnited States\t1963-05-25 00:00:00.0\tJazz\t80\t3hkTDhpVgfARwUytzxHZze\tThe Shacklefords - A Stranger In Your Town\t21\t1963\t1960\t3hkTDhpVgfARwUytzxHZze\t0.72\t0.375\t0.6459999999999999\t0.00441\t4\t0.13699999999999998\t-6.6579999999999995\t1\t0.055999999999999994\t78.023\t0.48700000000000004\t4\n"}]},"apps":[],"jobName":"paragraph_1526458718702_944741784","id":"20180516-041429_1444090304","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8871","user":"admin","dateFinished":"2018-05-16T09:24:38+0000","dateStarted":"2018-05-16T09:24:36+0000"},{"text":"%md\n\nFirst, let's drop some columns that won't be useful anymore.\n\nFor removing columns, we can use `drop` function.","dateUpdated":"2018-05-16T09:02:34+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>First, let's drop some columns that won't be useful anymore.</p>\n<p>For removing columns, we can use <code>drop</code> function.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718703_944357036","id":"20180515-053713_1192436093","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8872","user":"admin","dateFinished":"2018-05-16T09:02:35+0000","dateStarted":"2018-05-16T09:02:35+0000"},{"text":"%spark2.pyspark\n\nz.show(\n    mergedDF\n    .drop(mergedDF['track_id'])\n    .drop(mergedDF['year'])\n    .limit(10)\n)","dateUpdated":"2018-05-16T09:24:57+0000","config":{"colWidth":6,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\tartist\ttitle\tcountry\tdate\tgenre\trank\tartist_song\tscore\tdecade\tid\tacousticness\tdanceability\tenergy\tinstrumentalness\tkey\tliveness\tloudness\tmode\tspeechiness\ttempo\tvalence\ttime_signature\n170891\tPajama Party\tYo No Se\tUnited States\t1989-07-22 00:00:00.0\tPop\t93\tPajama Party - Yo No Se\t8\t1980\t4tNn9trTmARqzz6NuwMMKn\t5.41E-4\t0.767\t0.797\t0.311\t7\t0.0776\t-12.349\t1\t0.0717\t122.836\t0.8270000000000001\t4\n170950\tThe Call\tLet The Day Begin\tUnited States\t1989-07-22 00:00:00.0\tRock\t91\tThe Call - Let The Day Begin\t10\t1980\t59YYheZHNWi44imVPTp8hX\t0.0457\t0.58\t0.92\t0.00909\t2\t0.106\t-7.388\t1\t0.0696\t124.14200000000001\t0.45\t4\n171187\tDebbie Gibson\tNo More Rhyme\tUnited States\t1989-12-08 00:00:00.0\tPop\t17\tDebbie Gibson - No More Rhyme\t84\t1980\t6K34QHQLwxyRlvEZMS7XUf\t0.465\t0.56\t0.442\t3.34E-6\t9\t0.264\t-7.861000000000001\t1\t0.0281\t74.132\t0.247\t4\n171577\tStevie B\tIn My Eyes\tUnited States\t1989-09-09 00:00:00.0\tPop\t71\tStevie B - In My Eyes\t30\t1980\t2I8yCOvR8g4oHkAMY5Mmd8\t0.00125\t0.7\t0.6629999999999999\t3.35E-4\t6\t0.0648\t-11.285\t1\t0.0549\t124.95299999999999\t0.7879999999999999\t4\n171616\tStage Dolls\tLove Cries\tNorway\t1989-09-09 00:00:00.0\tRock\t53\tStage Dolls - Love Cries\t48\t1980\t6MUyFoeNwe2i47zzxr20FY\t0.0098\t0.415\t0.932\t9.46E-6\t6\t0.733\t-5.2589999999999995\t0\t0.0733\t134.39700000000002\t0.32\t4\n171642\tThe Graces\tLay Down Your Arms\tUnited States\t1989-09-09 00:00:00.0\tRock\t57\tThe Graces - Lay Down Your Arms\t44\t1980\t6AHvm8J1gpZlY3IkyreaFB\t0.0183\t0.564\t0.718\t7.18E-5\t7\t0.0957\t-9.837\t1\t0.0326\t131.201\t0.6559999999999999\t4\n171873\tMadonna\tCherish\tUnited States\t1989-09-30 00:00:00.0\tPop\t4\tMadonna - Cherish\t97\t1980\t7BLKBIoijWCkDyOATEr5vW\t0.289\t0.6920000000000001\t0.875\t3.27E-5\t2\t0.0675\t-4.5280000000000005\t1\t0.0345\t131.877\t0.9\t4\n172243\tRod Stewart\tHaving A Party\tEngland\t1994-04-23 00:00:00.0\tRock\t65\tRod Stewart - Having A Party\t36\t1990\t2TBnYW00VGuNJk6xVQYEQe\t0.147\t0.648\t0.789\t0.0\t4\t0.972\t-9.47\t1\t0.10300000000000001\t129.58700000000002\t0.711\t4\n172305\tEternal\tStay\tUnited States\t1994-04-30 00:00:00.0\tR&B\t49\tEternal - Stay\t52\t1990\t2SPFC3GXog3hBb24Ww9sFV\t0.00411\t0.591\t0.727\t1.53E-6\t10\t0.0289\t-8.058\t0\t0.054000000000000006\t98.52799999999999\t0.846\t4\n173056\tNine Inch Nails\tCloser\tUnited States\t1994-06-25 00:00:00.0\tMetal\t87\tNine Inch Nails - Closer\t14\t1990\t39tLc4Xp58Lu4KcWHggeE2\t3.65E-4\t0.5589999999999999\t0.725\t0.5529999999999999\t10\t0.11199999999999999\t-8.631\t0\t0.0426\t90.012\t0.501\t4\n"}]},"apps":[],"jobName":"paragraph_1526458718703_944357036","id":"20180507-133133_1580487990","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8873","user":"admin","dateFinished":"2018-05-16T09:24:59+0000","dateStarted":"2018-05-16T09:24:58+0000"},{"text":"%spark2.pyspark\n\nmergedDF = mergedDF.drop(\"rank\",\"year\",\"artist_song\",\"score\", \"id\")\n\nz.show(mergedDF.limit(10))","dateUpdated":"2018-05-16T09:25:04+0000","config":{"editorSetting":{"language":"python"},"colWidth":6,"editorMode":"ace/mode/python","editorHide":false,"results":{"0":{"graph":{"mode":"table","height":346,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"artist\ttitle\tcountry\tdate\tgenre\ttrack_id\tdecade\tacousticness\tdanceability\tenergy\tinstrumentalness\tkey\tliveness\tloudness\tmode\tspeechiness\ttempo\tvalence\ttime_signature\nThe Marvelettes\tToo Many Fish In The Sea\tUnited States\t1964-11-14 00:00:00.0\tSoul\t0PgZO2KF47yBddD48hj9Rd\t1960\t0.135\t0.79\t0.5479999999999999\t1.4599999999999999E-5\t0\t0.308\t-13.610999999999999\t1\t0.0406\t91.947\t0.9640000000000001\t4\nBobby Vinton\tJust As Much As Ever\tUnited States\t1968-01-13 00:00:00.0\tTraditional Pop\t3RfkdH5PGEn0pJpbV4H8qp\t1960\t0.883\t0.442\t0.11199999999999999\t0.0\t1\t0.138\t-15.924000000000001\t1\t0.0298\t85.01\t0.33299999999999996\t4\nLittle Willie John\tTake My Love (I Want To Give It All To You)\tUnited States\t1961-09-23 00:00:00.0\tSoul\t0Xxoa4TSPt1zSAURgzKJN1\t1960\t0.691\t0.475\t0.456\t0.0\t1\t0.0662\t-13.244000000000002\t1\t0.0423\t66.118\t0.77\t4\nThe Dovells\tBristol Stomp\tUnited States\t1961-10-14 00:00:00.0\tTraditional Pop\t0B1cm1Z7J9v8Wug9idr8T6\t1960\t0.56\t0.665\t0.7879999999999999\t0.0\t2\t0.524\t-6.146\t1\t0.0639\t105.62\t0.907\t4\nBuster Brown\tFannie Mae\tUnited States\t1960-03-26 00:00:00.0\tBlues\t1ySkB2a4SFjhWwIpkdJBzw\t1960\t0.759\t0.664\t0.449\t0.00277\t5\t0.24100000000000002\t-10.184\t1\t0.0283\t119.93\t0.828\t4\nMarvin Gaye\tYou\tUnited States\t1968-01-27 00:00:00.0\tSoul\t0XVL0KnJsZ52cCGimf2t7J\t1960\t0.264\t0.644\t0.597\t0.0\t0\t0.254\t-6.455\t1\t0.0332\t110.40799999999999\t0.9009999999999999\t4\nJim & Jean\tPeople World\tUnited States\t1968-03-02 00:00:00.0\tFolk\t16ZfZjJ4lhighF4tJHQbQy\t1960\t0.13\t0.49\t0.488\t0.0\t4\t0.142\t-12.793\t1\t0.0355\t138.026\t0.59\t4\nBobby Hebb\tSunny\tUnited States\t1966-09-07 00:00:00.0\tSoul\t1GVafg6PWpBt5rWTMruzwG\t1960\t0.851\t0.7190000000000001\t0.33799999999999997\t3.33E-6\t4\t0.348\t-11.175\t0\t0.0418\t128.346\t0.7509999999999999\t4\nBaby Washington\tThat's How Heartaches Are Made\tUnited States\t1963-05-18 00:00:00.0\tSoul\t5LJjg4XXwyHVuohOKsI60g\t1960\t0.47100000000000003\t0.58\t0.40399999999999997\t0.0\t9\t0.265\t-10.099\t1\t0.0285\t98.91799999999999\t0.467\t4\nThe Shacklefords\tA Stranger In Your Town\tUnited States\t1963-05-25 00:00:00.0\tJazz\t3hkTDhpVgfARwUytzxHZze\t1960\t0.72\t0.375\t0.6459999999999999\t0.00441\t4\t0.13699999999999998\t-6.6579999999999995\t1\t0.055999999999999994\t78.023\t0.48700000000000004\t4\n"}]},"apps":[],"jobName":"paragraph_1526458718703_944357036","id":"20180515-054136_1488021248","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8874","user":"admin","dateFinished":"2018-05-16T09:25:06+0000","dateStarted":"2018-05-16T09:25:04+0000"},{"text":"%md\n\nLet's write our \"**mergedDF**\" data frame to HDFS with `write` method of spark.\n\nAs you remember we can read data in `csv`, `parquet`, `json`, `orc` and `text`. \n\nSame as you can write in these file types.","dateUpdated":"2018-05-16T09:25:19+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Let's write our &ldquo;<strong>mergedDF</strong>&rdquo; data frame to HDFS with <code>write</code> method of spark.</p>\n<p>As you remember we can read data in <code>csv</code>, <code>parquet</code>, <code>json</code>, <code>orc</code> and <code>text</code>.</p>\n<p>Same as you can write in these file types.</p>\n"}]},"apps":[],"jobName":"paragraph_1526458718704_954745256","id":"20180516-052832_1519292833","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8875","user":"admin","dateFinished":"2018-05-16T09:02:37+0000","dateStarted":"2018-05-16T09:02:37+0000"},{"text":"%spark2.pyspark\n\nmergedDF.write.parquet(\"/user/userX/zpl/tracks.parquet\")","dateUpdated":"2018-05-16T09:28:30+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1526458718704_954745256","id":"20180516-052812_478018982","dateCreated":"2018-05-16T08:18:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8876","user":"admin","dateFinished":"2018-05-16T09:28:14+0000","dateStarted":"2018-05-16T09:28:07+0000"},{"text":"%spark2.pyspark\n","user":"admin","dateUpdated":"2018-05-16T09:29:01+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526462941542_-211625183","id":"20180516-092901_1293572275","dateCreated":"2018-05-16T09:29:01+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:23963"}],"name":"workshops/spark_DF_workshop","id":"2DFK1HJAP","angularObjects":{"2CHS8UYQQ:shared_process":[],"2CKX8WPU1:admin:":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:admin:":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}